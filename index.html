<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù‡Ø§Ø´ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ  â€” Prototype Ø¬Ø§Ù‡Ø² Ø¹Ø±Ø¶</title>
  <meta name="description" content="Ù…Ù†ØµØ© Ø£ÙØ«ÙØ±: ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ø£ÙŠ Ø§Ù„Ø¹Ø§Ù… Ø¥Ù„Ù‰ Ù…Ù‡Ø§Ù… Ø¥Ø¹Ù„Ø§Ù…ÙŠØ© ØªØ¯Ø±ÙŠØ¨ÙŠØ© â€” Ù†Ù…ÙˆØ°Ø¬ Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø¹Ø±Ø¶." />

  <style>
    :root{
      --bg:#F7F8FB; --card:#fff; --text:#0F172A; --muted:#64748B; --border:#E2E8F0;
      --shadow:0 10px 30px rgba(15,23,42,.08);
      --primary:#1F2937; --secondary:#6366F1; --accent:#10B981; --danger:#EF4444;
      --radius:18px; --radius-sm:12px; --pad:18px; --max:1120px;

      --heroGrad: radial-gradient(1200px 500px at 70% -10%, rgba(99,102,241,.25), transparent 55%),
                  radial-gradient(900px 400px at 10% 0%, rgba(16,185,129,.18), transparent 60%),
                  linear-gradient(180deg, #FFFFFF, var(--bg));
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Tahoma, Arial, "Noto Kufi Arabic", "Noto Sans Arabic", sans-serif;
      line-height:1.75;
    }
    .container{ width:min(var(--max), calc(100% - 32px)); margin-inline:auto; }
    .nav{
      position:sticky; top:0; z-index:30;
      background:rgba(247,248,251,.78); backdrop-filter:blur(10px);
      border-bottom:1px solid var(--border);
    }
    .nav-inner{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 0; }
    .brand{ display:flex; align-items:center; gap:10px; cursor:pointer; user-select:none; }
    
    .logo{
  width: 50px;; 
  height: 50px;; 
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;     /* Ù…Ù‡Ù… Ø¬Ø¯Ù‹Ø§ */
}

.logo img{
  width: 50px;
  height: 50px;
  object-fit: contain;
}

    .brand .title{ display:flex; flex-direction:column; line-height:1.2; }
    .brand .title strong{ font-size:15px; }
    .brand .title span{ font-size:12px; color:var(--muted); }

    .nav-links{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; justify-content:flex-end; }

    .btn{
      border:1px solid var(--border); background:#fff; color:var(--text);
      padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:700;
      display:inline-flex; align-items:center; gap:8px; white-space:nowrap;
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease, opacity .12s ease;
    }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 10px 25px rgba(15,23,42,.08); border-color:#cbd5e1; }
    .btn:active{ transform:translateY(0); box-shadow:none; }
    .btn.primary{
      background:linear-gradient(135deg, var(--secondary), #4F46E5);
      border-color:transparent; color:#fff; box-shadow:0 12px 30px rgba(99,102,241,.25);
    }
    .btn.primary:hover{ box-shadow:0 14px 34px rgba(99,102,241,.30); }
    .btn.ghost{ background:transparent; border-color:transparent; color:var(--muted); }
    .btn.ghost:hover{ background:rgba(255,255,255,.85); border-color:var(--border); color:var(--text); }
    .btn.small{ padding:8px 12px; font-size:13px; }
    .btn.danger{ background:rgba(239,68,68,.08); border-color:rgba(239,68,68,.20); color:#991b1b; }
    .btn.success{ background:rgba(16,185,129,.10); border-color:rgba(16,185,129,.25); color:#0f766e; }

    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      background:#fff; border:1px solid var(--border); box-shadow:var(--shadow);
      font-size:12px; font-weight:800; color:var(--muted);
    }
    .chip b{ color:var(--text); }

    .hero{
      background:var(--heroGrad);
      border-bottom:1px solid var(--border);
      padding:30px 0 12px;
    }
    .hero-grid{
      display:grid; grid-template-columns:1.25fr .75fr;
      gap:14px; align-items:stretch; padding:18px 0 26px;
    }
    .hero-card{
      background:rgba(255,255,255,.78); border:1px solid var(--border);
      border-radius:var(--radius); padding:22px; box-shadow:var(--shadow);
    }
    h1{ margin:0 0 10px; font-size:clamp(24px, 3.2vw, 40px); line-height:1.25; letter-spacing:-.4px; }
    .hero p{ margin:0 0 14px; color:var(--muted); font-size:15px; }
    .hero-actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .mini-stats{ display:grid; gap:12px; }
    .stat{
      background:#fff; border:1px solid var(--border); border-radius:var(--radius);
      padding:18px; box-shadow:var(--shadow); position:relative; overflow:hidden;
    }
    .stat::before{
      content:""; position:absolute; inset:-40px -40px auto auto; width:140px; height:140px;
      border-radius:999px; background:radial-gradient(circle at 30% 30%, rgba(16,185,129,.20), transparent 60%);
      transform:rotate(20deg);
    }
    .stat strong{ display:block; font-size:18px; margin-bottom:4px; }
    .stat span{ color:var(--muted); font-size:13px; }

    section{ padding:18px 0; }
    .section-title{ display:flex; align-items:baseline; justify-content:space-between; gap:12px; margin-bottom:12px; }
    .section-title h2{ margin:0; font-size:18px; letter-spacing:-.2px; }
    .section-title p{ margin:0; color:var(--muted); font-size:13px; }

    .grid-3{ display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; }
    .grid-2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }

    .card{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:var(--pad); box-shadow:var(--shadow); }
    .card h3{ margin:0 0 6px; font-size:15px; }
    .card p{ margin:0; color:var(--muted); font-size:13px; }

    .step{ display:flex; gap:12px; align-items:flex-start; }
    .icon{
      width:42px; height:42px; border-radius:14px;
      background:rgba(99,102,241,.12); border:1px solid rgba(99,102,241,.25);
      display:grid; place-items:center; color:var(--secondary); font-weight:900; flex:0 0 auto;
    }

    .timeline{ display:grid; gap:12px; }
    .trow{ display:grid; grid-template-columns:64px 1fr; gap:12px; align-items:stretch; }
    .tleft{ display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding-top:4px; }
    .tdot{
      width:42px; height:42px; border-radius:14px;
      background:linear-gradient(135deg, rgba(99,102,241,.15), rgba(16,185,129,.12));
      border:1px solid var(--border); display:grid; place-items:center; font-weight:900; color:var(--primary);
      box-shadow:var(--shadow);
    }
    .tline{ width:2px; flex:1; background:linear-gradient(180deg, rgba(99,102,241,.45), rgba(16,185,129,.35)); border-radius:99px; margin-top:8px; }

    .toolbar{
      display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between;
      margin:10px 0 12px;
    }
    .search{
      display:flex; align-items:center; gap:8px;
      background:#fff; border:1px solid var(--border); border-radius:999px; padding:8px 12px;
      min-width:min(520px, 100%); box-shadow:var(--shadow);
    }
    .search input{ border:none; outline:none; width:100%; font-size:14px; background:transparent; color:var(--text); }

    select{
      border:1px solid var(--border); background:#fff; border-radius:999px;
      padding:10px 12px; font-weight:750; box-shadow:var(--shadow); cursor:pointer; outline:none;
    }

    .tabs{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
      margin:6px 0 12px;
    }
    .tab{
      padding:8px 12px; border-radius:999px;
      border:1px solid var(--border); background:#fff; box-shadow:var(--shadow);
      font-weight:800; font-size:12px; cursor:pointer; color:var(--muted);
    }
    .tab.active{
      color:#fff; border-color:transparent;
      background:linear-gradient(135deg, var(--secondary), #4F46E5);
      box-shadow:0 14px 30px rgba(99,102,241,.25);
    }

    .tasks-grid{ display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; }
    .task-card{ position:relative; overflow:hidden; }
    .task-card::after{
      content:""; position:absolute; inset:auto -40px -55px -40px; height:120px;
      background:radial-gradient(220px 120px at 50% 30%, rgba(99,102,241,.18), transparent 60%);
      pointer-events:none;
    }

    .pill-row{ display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 12px; }
    .pill{
      font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid var(--border); background:rgba(248,250,252,.95);
      color:var(--muted); font-weight:800;
    }
    .pill.good{ border-color:rgba(16,185,129,.35); background:rgba(16,185,129,.10); color:#0f766e; }
    .pill.mid{ border-color:rgba(99,102,241,.35); background:rgba(99,102,241,.10); color:#3730a3; }
    .pill.hard{ border-color:rgba(239,68,68,.25); background:rgba(239,68,68,.08); color:#991b1b; }
    .pill.reviewed{ border-color:rgba(99,102,241,.35); background:rgba(99,102,241,.10); color:#3730a3; }
    .pill.needs{ border-color:rgba(239,68,68,.25); background:rgba(239,68,68,.08); color:#991b1b; }

    .task-title{ margin:0 0 6px; font-weight:900; font-size:15px; }
    .task-desc{ margin:0 0 12px; color:var(--muted); font-size:13px; min-height:44px; }
    .task-footer{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:6px; position:relative; z-index:2; }
    .meta{ font-size:12px; color:var(--muted); font-weight:800; }

    .view{ display:none; }
    .view.active{ display:block; }

    .backdrop{
      position:fixed; inset:0; background:rgba(15,23,42,.55);
      display:none; align-items:center; justify-content:center; padding:18px; z-index:60;
    }
    .backdrop.show{ display:flex; }
    .modal{
      width:min(900px, 100%); background:#fff; border:1px solid var(--border);
      border-radius:22px; box-shadow:0 30px 80px rgba(0,0,0,.25); overflow:hidden;
      animation:pop .18s ease;
    }
    @keyframes pop{ from{ transform:translateY(10px); opacity:.7 } to{ transform:translateY(0); opacity:1 } }
    .modal-head{
      padding:18px 18px 14px; border-bottom:1px solid var(--border);
      background:linear-gradient(180deg, rgba(99,102,241,.08), rgba(16,185,129,.06));
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    .modal-head h3{ margin:0; font-size:17px; letter-spacing:-.2px; }
    .modal-head p{ margin:6px 0 0; color:var(--muted); font-size:13px; }
    .modal-body{ padding:18px; }
    .modal-grid{ display:grid; grid-template-columns:1.15fr .85fr; gap:12px; }
    .panel{ background:#fff; border:1px solid var(--border); border-radius:18px; padding:14px; }
    .panel h4{ margin:0 0 8px; font-size:14px; }
    .panel ul{ margin:0; padding:0 18px 0 0; color:var(--muted); font-size:13px; }
    .panel li{ margin:6px 0; }

    .upload{ display:grid; gap:10px; }
    .upload textarea{
      width:100%; min-height:110px; border-radius:16px; border:1px solid var(--border);
      padding:12px; outline:none; resize:vertical; font-family:inherit; font-size:14px;
    }
    .upload input[type="file"]{
      width:100%; border:1px dashed #cbd5e1; border-radius:16px; padding:12px;
      background:rgba(248,250,252,.95); cursor:pointer;
    }
    .modal-foot{
      padding:14px 18px 18px; border-top:1px solid var(--border);
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
    .note{ color:var(--muted); font-size:12px; font-weight:800; }

    .toast{
      position:fixed; bottom:18px; inset-inline:18px; margin-inline:auto;
      width:min(780px, calc(100% - 36px)); background:#fff; border:1px solid var(--border);
      border-radius:18px; padding:12px 14px; box-shadow:0 20px 60px rgba(15,23,42,.18);
      display:none; align-items:center; justify-content:space-between; gap:12px; z-index:70;
    }
    .toast.show{ display:flex; }

    .onboard{
      width:min(720px, 100%); background:#fff; border:1px solid var(--border);
      border-radius:22px; box-shadow:0 30px 80px rgba(0,0,0,.25); overflow:hidden;
      animation:pop .18s ease;
    }
    .form{ display:grid; gap:10px; }
    .form .row{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    .field{ display:grid; gap:6px; }
    .field label{ font-size:12px; font-weight:900; color:var(--muted); }
    .field input{
      border:1px solid var(--border); border-radius:16px; padding:12px;
      outline:none; font-size:14px; background:#fff;
    }
    .role-pills{ display:flex; gap:8px; flex-wrap:wrap; }
    .role{
      border:1px solid var(--border); background:#fff; color:var(--muted);
      padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:900;
      box-shadow:var(--shadow);
    }
    .role.active{
      color:#fff; border-color:transparent;
      background:linear-gradient(135deg, var(--secondary), #4F46E5);
      box-shadow:0 14px 30px rgba(99,102,241,.25);
    }

    table{ width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:16px; border:1px solid var(--border); background:#fff; box-shadow:var(--shadow); }
    th, td{ padding:12px; text-align:right; font-size:13px; }
    th{ background:rgba(248,250,252,.95); color:var(--muted); font-weight:900; border-bottom:1px solid var(--border); }
    td{ border-bottom:1px solid var(--border); vertical-align:top; }
    tr:last-child td{ border-bottom:none; }
    .muted{ color:var(--muted); }
    .right-actions{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-start; }

    footer{ padding:22px 0 30px; color:var(--muted); font-size:12px; }
    .footer-grid{ display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; border-top:1px solid var(--border); padding-top:14px; }

    @media (max-width: 980px){
      .hero-grid{ grid-template-columns:1fr; }
      .grid-3, .grid-2{ grid-template-columns:1fr; }
      .tasks-grid{ grid-template-columns:1fr; }
      .modal-grid{ grid-template-columns:1fr; }
      .search{ min-width:100%; }
      .form .row{ grid-template-columns:1fr; }
      .trow{ grid-template-columns:56px 1fr; }
      
    }
  </style>
</head>

<body>
  <!-- NAV -->
  <div class="nav">
    <div class="container nav-inner">
      <div class="brand" id="goHome" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
<div class="logo">
  <img src="WhatsApp Image 2025-12-24 at 10.41.44 AM.jpeg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØµØ©">
</div>

        <div class="title">
          <strong>Ù‡Ø§Ø´ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ  </strong>
          <span id="subtitle"> Ù†Ù‚Ø¯ Ø­Ù‚ÙŠÙ‚ÙŠ. ØªØ¯Ø±ÙŠØ¨ Ø­Ù‚ÙŠÙ‚ÙŠ. Ø£Ø«Ø± Ø­Ù‚ÙŠÙ‚ÙŠ.     </span>
        </div>
      </div>

      <div class="nav-links">
        <span class="chip" id="userChip" style="display:none;">ğŸ‘¤ <b id="userNameChip">â€”</b> â€¢ <span id="userRoleChip">â€”</span></span>
        <button class="btn ghost" data-view="homeView">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button class="btn ghost" data-view="howView">ÙƒÙŠÙ ØªØ¹Ù…Ù„ØŸ</button>
        <button class="btn ghost" data-view="tasksView">Ø§Ù„Ù…Ù‡Ø§Ù…</button>
        <button class="btn ghost" data-view="dashboardView" id="navDashboard" style="display:none;">Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</button>
        <button class="btn ghost" data-view="adminView" id="navAdmin" style="display:none;">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</button>
        <button class="btn primary" id="startNow">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
      </div>
    </div>
  </div>

  <!-- HOME VIEW -->
  <main class="view active" id="homeView">
    <header class="hero">
      <div class="container hero-grid">
        <div class="hero-card">
          <h1>Ø­ÙˆÙ‘Ù„ Ø§Ù„Ù†Ù‚Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠ Ø¥Ù„Ù‰ ØªØ¯Ø±ÙŠØ¨ Ø¹Ù…Ù„ÙŠ Ø­Ù‚ÙŠÙ‚ÙŠ</h1>
          <p>
            Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø¢Ø±Ø§Ø¡ Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ø§Ù„Ø³ÙˆÙ‚ØŒ ÙˆØªØ­ÙˆÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ù…Ù‡Ø§Ù… ØªØ¯Ø±ÙŠØ¨ÙŠØ© ÙˆØ§Ø¶Ø­Ø© ØªØ­Ø§ÙƒÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠ â€”
            Ø¨Ø¯ÙˆÙ† Ø¯Ø±Ø¬Ø§Øª ÙˆÙ„Ø§ Ø¶ØºØ·. Ø§Ù„Ù‡Ø¯Ù: Ù…Ù‡Ø§Ø±Ø§Øª ÙˆÙ…Ø®Ø±Ø¬Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø¹Ø±Ø¶ ÙÙŠ Ù…Ù„ÙÙƒ Ø§Ù„Ù…Ù‡Ù†ÙŠ.
          </p>
          <div class="hero-actions">
            <button class="btn primary" data-view="tasksView">Ø§Ø³ØªØ¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù…</button>
            <button class="btn" data-view="howView">Ø´Ø§Ù‡Ø¯ ÙƒÙŠÙ ØªØ¹Ù…Ù„</button>
            <button class="btn" id="openDemoTask">Ø§ÙØªØ­ Ù…Ù‡Ù…Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
          </div>
        </div>

        <div class="mini-stats">
          <div class="stat">
            <strong id="statTasks">â€”</strong>
            <span>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</span>
          </div>
          <div class="stat">
            <strong>Ø¨Ø¯ÙˆÙ† Ù…Ù†Ø§ÙØ³Ø©</strong>
            <span>ÙÙŠ Ø§Ù„Ù€ MVP Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù„Ù… Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„ØªØ±ØªÙŠØ¨</span>
          </div>
          <div class="stat">
            <strong>Portfolio-ready</strong>
            <span>ÙƒÙ„ Ù…Ù‡Ù…Ø© Ù„Ù‡Ø§ Ù…Ø®Ø±Ø¬ ÙˆØ§Ø¶Ø­ ÙŠÙ…ÙƒÙ†Ùƒ Ø¹Ø±Ø¶Ù‡</span>
          </div>
        </div>
      </div>
    </header>

    <section>
      <div class="container">
        <div class="section-title">
          <div>
            <h2>Ù„Ù…Ø§Ø°Ø§ Ù‡Ø°Ù‡ Ø§Ù„ÙÙƒØ±Ø© Ù‚ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ØŸ</h2>
            <p>Ù‚ØµØ© Ø¨Ø³ÙŠØ·Ø©: ØªØ¹Ù„ÙŠÙ‚ Ø³Ù„Ø¨ÙŠ â†’ Ù…Ù‡Ù…Ø© â†’ ØªØ³Ù„ÙŠÙ… â†’ Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3>ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³Ù„Ø¨ÙŠ Ø¥Ù„Ù‰ Ù‚ÙŠÙ…Ø©</h3>
            <p>Ø¨Ø¯Ù„ Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ù†Ù‚Ø¯ Ù…Ø¬Ø±Ø¯ Ø¶Ø¬ÙŠØ¬ØŒ ÙŠØµØ¨Ø­ Ù…Ø§Ø¯Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ© ØªØµÙ‚Ù„ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª ÙˆØªØ¨Ù†ÙŠ Ø§Ù„Ø®Ø¨Ø±Ø©.</p>
          </div>
          <div class="card">
            <h3>Ù…Ø­Ø§ÙƒØ§Ø© Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ù…Ù„</h3>
            <p>Ø§Ù„Ù…Ù‡Ø§Ù… ØªØ´Ø¨Ù‡ Ø§Ù„ÙˆØ§Ù‚Ø¹: ØªØ­Ø³ÙŠÙ† Ø¹Ù†ÙˆØ§Ù†ØŒ Ø¶Ø¨Ø· Ù†Ø¨Ø±Ø©ØŒ Ø¥Ø®Ø±Ø§Ø¬ Ø¨ØµØ±ÙŠØŒ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ ØªÙˆØ§ØµÙ„â€¦ Ø¥Ù„Ø®.</p>
          </div>
          <div class="card">
            <h3>ØªÙ†ÙÙŠØ° Ø³Ø±ÙŠØ¹ (MVP)</h3>
            <p>Ù†Ù‚Ø¯Ø± Ù†Ø¹Ø±Ø¶ Ù†Ø³Ø®Ø© Ø´ØºÙ‘Ø§Ù„Ø© Ø®Ù„Ø§Ù„ Ø£ÙŠØ§Ù…: Ù‚Ø§Ø¦Ù…Ø© Ù…Ù‡Ø§Ù… + ØªØ³Ù„ÙŠÙ… + Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø¨Ø³Ø·Ø©.</p>
          </div>
          <div class="card">
            <h3>Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙˆØ³Ø¹</h3>
            <p>Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù… ÙŠÙ…ÙƒÙ† Ù†Ù‚Ù„ Ù†ÙØ³ Ø§Ù„Ù…Ù†Ù‡Ø¬ Ù„ØªØ®ØµØµØ§Øª Ø£Ø®Ø±Ù‰ Ù…Ø«Ù„ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©.</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- HOW VIEW -->
  <section class="view" id="howView">
    <div class="container">
      <div class="section-title">
        <div>
          <h2>ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ù…Ù†ØµØ© Ø£ÙØ«ÙØ±ØŸ (Story)</h2>
          <p>Timeline ÙˆØ§Ø¶Ø­ â€” Ù…Ù…ØªØ§Ø² Ù„Ù„Ø´Ø±Ø­ ÙÙŠ Pitch</p>
        </div>
        <button class="btn" data-view="tasksView">Ø§Ø³ØªØ¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù…</button>
      </div>

      <div class="card timeline">
        <div class="trow">
          <div class="tleft">
            <div class="tdot">1</div>
            <div class="tline"></div>
          </div>
          <div class="panel">
            <h4>ØªØ¹Ù„ÙŠÙ‚ / Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù† Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±</h4>
            <p class="muted" style="margin:0">
              Ù…Ø«Ø§Ù„: â€œØ§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ù…Ø²Ø¯Ø­Ù…â€¦ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø¨Ø§Ù„Øºâ€¦ Ø§Ù„Ø±Ø¯ÙˆØ¯ Ù…ØªØ£Ø®Ø±Ø©â€¦â€
            </p>
          </div>
        </div>

        <div class="trow">
          <div class="tleft">
            <div class="tdot">2</div>
            <div class="tline"></div>
          </div>
          <div class="panel">
            <h4>ØªØ­Ù„ÙŠÙ„ ÙˆØªØµÙ†ÙŠÙ ÙˆØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ù…Ù‡Ù…Ø©</h4>
            <p class="muted" style="margin:0">
              NLP ÙŠØµÙ†Ù‘Ù Ø§Ù„Ù…Ø´ÙƒÙ„Ø© (ØªØµÙ…ÙŠÙ…/Ø¥Ø®Ø±Ø§Ø¬/Ù…Ø­ØªÙˆÙ‰/ØªÙˆØ§ØµÙ„) ÙˆÙŠÙˆÙ„Ù‘Ø¯ Ù…Ù‡Ù…Ø© Ù…Ø¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙˆÙ…Ø¹Ø§ÙŠÙŠØ± Ù†Ø¬Ø§Ø­ Ù…Ø¨Ø³Ø·Ø©.
            </p>
          </div>
        </div>

        <div class="trow">
          <div class="tleft">
            <div class="tdot">3</div>
          </div>
          <div class="panel">
            <h4>ØªØ³Ù„ÙŠÙ… + Ù…Ø±Ø§Ø¬Ø¹Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h4>
            <p class="muted" style="margin:0">
              Ø§Ù„Ø·Ø§Ù„Ø¨ ÙŠØ±ÙØ¹ Ø§Ù„Ù…Ø®Ø±Ø¬ (Ù†Øµ/ØªØµÙ…ÙŠÙ…/Ø®Ø·Ø©)ØŒ Ø«Ù… ÙŠØ³ØªÙ„Ù… Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© â€œReviewedâ€ Ø£Ùˆ â€œNeeds Improvementâ€.
            </p>
          </div>
        </div>
      </div>

      <div class="grid-3" style="margin-top:12px;">
        <div class="card step">
          <div class="icon">A</div>
          <div>
            <h3>Ø¨Ø¯ÙˆÙ† Ø¶ØºØ·</h3>
            <p>ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ø§ Ù†Ù‚Ø§Ø· ÙˆÙ„Ø§ ØªØ±ØªÙŠØ¨â€¦ Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ ØªØ¹Ù„Ù… Ø­Ù‚ÙŠÙ‚ÙŠ ÙˆØ¹Ø§Ø¯Ù„.</p>
          </div>
        </div>
        <div class="card step">
          <div class="icon">B</div>
          <div>
            <h3>Ù…Ø®Ø±Ø¬Ø§Øª ÙˆØ§Ø¶Ø­Ø©</h3>
            <p>ÙƒÙ„ Ù…Ù‡Ù…Ø© Ù„Ù‡Ø§ Deliverable Ù…Ø­Ø¯Ø¯ ÙŠØµÙ„Ø­ Ù„Ù„Ù€ Portfolio.</p>
          </div>
        </div>
        <div class="card step">
          <div class="icon">C</div>
          <div>
            <h3>Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ³Ø¹</h3>
            <p>Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙÙŠÙ†/Ø¬Ø§Ù…Ø¹Ø§Øª/Ø´Ù‡Ø§Ø¯Ø§Øª Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TASKS VIEW -->
  <section class="view" id="tasksView">
    <div class="container">
      <div class="section-title">
        <div>
          <h2>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h2>
          <p>Ø¨Ø­Ø« + ÙÙ„ØªØ±Ø© + ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø­Ø§Ù„Ø© + ÙØªØ­ Ù…Ù‡Ù…Ø© + ØªØ³Ù„ÙŠÙ…</p>
        </div>
        <div class="right-actions">
          <button class="btn" id="genFromCommentBtn">âœ¨ ØªÙˆÙ„ÙŠØ¯ Ù…Ù‡Ù…Ø© Ù…Ù† ØªØ¹Ù„ÙŠÙ‚</button>
          <button class="btn" data-view="dashboardView" id="goDashBtn" style="display:none;">Ø§Ø°Ù‡Ø¨ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</button>
          <button class="btn primary" id="newTaskCTA">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
        </div>
      </div>

      <div class="tabs" id="statusTabs">
        <button class="tab active" data-status="all">Ø§Ù„ÙƒÙ„</button>
        <button class="tab" data-status="saved">Ù…Ø­ÙÙˆØ¸Ø© â­</button>
        <button class="tab" data-status="submitted">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ âœ…</button>
        <button class="tab" data-status="reviewed">ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ğŸŸ£</button>
        <button class="tab" data-status="needs">Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ† ğŸ”´</button>
      </div>

      <div class="toolbar">
        <div class="search">
          ğŸ” <input id="q" type="search" placeholder="Ø§Ø¨Ø­Ø«: Ø¹Ù†ÙˆØ§Ù†ØŒ ØªØµÙ†ÙŠÙØŒ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ù…Ù† Ø§Ù„ÙˆØµÙâ€¦" autocomplete="off" />
        </div>

        <div class="right-actions">
          <select id="category">
            <option value="all">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
          </select>
          <select id="difficulty">
            <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</option>
            <option value="Ø³Ù‡Ù„">Ø³Ù‡Ù„</option>
            <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
            <option value="ØµØ¹Ø¨">ØµØ¹Ø¨</option>
          </select>
          <button class="btn small" id="reset">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
        </div>
      </div>

      <div class="tasks-grid" id="tasksGrid"></div>
    </div>
  </section>

  <!-- DASHBOARD VIEW -->
  <section class="view" id="dashboardView">
    <div class="container">
      <div class="section-title">
        <div>
          <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
          <p>Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØ§Ù…Ù„Ø©: Ù…Ù‡Ø§Ù…Ùƒ + Ø§Ù„Ø­Ø§Ù„Ø© + Ø¥Ø¹Ø§Ø¯Ø© Ø±ÙØ¹</p>
        </div>
        <div class="right-actions">
          <button class="btn" data-view="tasksView">Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù…</button>
          <button class="btn danger" id="logoutBtn">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
      </div>

      <div class="grid-3">
        <div class="card">
          <h3>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</h3>
          <p class="muted">Ù…Ù‡Ø§Ù… Ù…Ø­ÙÙˆØ¸Ø© ÙˆÙ„Ù… ØªÙØ±Ø³Ù„ Ø¨Ø¹Ø¯</p>
          <div style="margin-top:10px; font-weight:900; font-size:18px;" id="dashInProgress">â€”</div>
        </div>
        <div class="card">
          <h3>ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</h3>
          <p class="muted">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø´Ø±Ù</p>
          <div style="margin-top:10px; font-weight:900; font-size:18px;" id="dashSubmitted">â€”</div>
        </div>
        <div class="card">
          <h3>Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…ÙƒØªÙ…Ù„Ø©</h3>
          <p class="muted">ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø£Ùˆ Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†</p>
          <div style="margin-top:10px; font-weight:900; font-size:18px;" id="dashReviewed">â€”</div>
        </div>
      </div>

      <div class="section-title" style="margin-top:16px;">
        <div>
          <h2>Ù…Ù‡Ø§Ù…ÙŠ</h2>
          <p>ÙŠØ¹Ø±Ø¶ Ø¢Ø®Ø± Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ</p>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th style="width:120px;">Ø§Ù„Ù…Ø¹Ø±Ù</th>
            <th>Ø§Ù„Ù…Ù‡Ù…Ø©</th>
            <th style="width:160px;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
            <th style="width:220px;">Ø¥Ø¬Ø±Ø§Ø¡</th>
          </tr>
        </thead>
        <tbody id="dashTable"></tbody>
      </table>
    </div>
  </section>

  <!-- ADMIN VIEW -->
  <section class="view" id="adminView">
    <div class="container">
      <div class="section-title">
        <div>
          <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù (Admin Light)</h2>
          <p>Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© + Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…Ø§Øª + Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
        </div>
        <div class="right-actions">
          <button class="btn" data-view="tasksView">Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒØ·Ø§Ù„Ø¨</button>
          <button class="btn danger" id="logoutAdminBtn">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
      </div>

      <div class="grid-2">
        <div class="card">
          <h3>Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø© (Demo)</h3>
          <p class="muted">ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©: ØªØªØ­ÙˆÙ„ Ù…Ù† Feedback Ø¹Ø¨Ø± NLP</p>

          <div class="form" style="margin-top:12px;">
            <div class="field">
              <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©</label>
              <input id="adminTitle" placeholder="Ù…Ø«Ø§Ù„: ØªØ­Ø³ÙŠÙ† Ù†Ø¨Ø±Ø© Ù…Ù†Ø´ÙˆØ±â€¦" />
            </div>
            <div class="row">
              <div class="field">
                <label>Ø§Ù„ØªØµÙ†ÙŠÙ</label>
                <input id="adminCategory" placeholder="Ù…Ø«Ø§Ù„: ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰" />
              </div>
              <div class="field">
                <label>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ (Ø³Ù‡Ù„/Ù…ØªÙˆØ³Ø·/ØµØ¹Ø¨)</label>
                <input id="adminDifficulty" placeholder="Ù…ØªÙˆØ³Ø·" />
              </div>
            </div>
            <div class="field">
              <label>ÙˆØµÙ Ù…Ø®ØªØµØ±</label>
              <input id="adminDesc" placeholder="ÙˆØµÙ ÙŠØ¸Ù‡Ø± ÙÙŠ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù‡Ù…Ø©" />
            </div>
            <div class="field">
              <label>ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label>
              <input id="adminProblem" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙƒÙ…Ø§ ÙŠÙÙ‡Ù…Ù‡Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨" />
            </div>
            <button class="btn primary" id="adminAddTask">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©</button>
          </div>
        </div>

        <div class="card">
          <h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
          <div class="grid-2" style="margin-top:12px;">
            <div class="panel">
              <h4 style="margin:0 0 6px;">Ø¹Ø¯Ø¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…Ø§Øª</h4>
              <div style="font-weight:900; font-size:20px;" id="adminSubCount">â€”</div>
            </div>
            <div class="panel">
              <h4 style="margin:0 0 6px;">Ù…Ø¹Ù„Ù‚Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h4>
              <div style="font-weight:900; font-size:20px;" id="adminPendingCount">â€”</div>
            </div>
          </div>
          <p class="muted" style="margin-top:10px;">* Ù‡Ø°Ø§ Demo: Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯ ØªØ¬Ø±ÙŠØ¨ÙŠ ÙŠØ±Ø³Ù„ ØªØ³Ù„ÙŠÙ…Ø§Øª.</p>
        </div>
      </div>

      <div class="section-title" style="margin-top:16px;">
        <div>
          <h2>Ø§Ù„ØªØ³Ù„ÙŠÙ…Ø§Øª</h2>
          <p>Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø© ÙˆØ­Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„Ø©: Reviewed Ø£Ùˆ Needs Improvement</p>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th style="width:120px;">Ø§Ù„Ù…Ø¹Ø±Ù</th>
            <th>Ø§Ù„Ø·Ø§Ù„Ø¨</th>
            <th>Ø§Ù„Ù…Ù‡Ù…Ø©</th>
            <th style="width:160px;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
            <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</th>
            <th style="width:200px;">Ø¥Ø¬Ø±Ø§Ø¡</th>
          </tr>
        </thead>
        <tbody id="adminTable"></tbody>
      </table>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="container footer-grid">
      <div>Â© Ù‡Ø§Ø´ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ â€” Ù†Ù…ÙˆØ°Ø¬ Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø¹Ø±Ø¶</div>
      <div>ÙŠØ´Ù…Ù„: Onboarding + Tasks + Student Dashboard + Admin Review + Demo NLP</div>
    </div>
  </footer>

  <!-- TASK MODAL -->
  <div class="backdrop" id="backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-head">
        <div>
          <h3 id="modalTitle">â€”</h3>
          <p id="modalSubtitle">â€”</p>
          <div class="pill-row" id="modalPills"></div>
        </div>
        <button class="btn small" id="closeModal">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
      </div>

      <div class="modal-body">
        <div class="modal-grid">
          <div class="panel">
            <h4>ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</h4>
            <p id="modalProblem" style="margin:0;color:var(--muted);font-size:13px;"></p>

            <hr style="border:none;border-top:1px solid var(--border);margin:12px 0;" />

            <h4>Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Deliverable)</h4>
            <ul id="modalDeliverables"></ul>

            <hr style="border:none;border-top:1px solid var(--border);margin:12px 0;" />

            <h4>Ù…Ø¹Ø§ÙŠÙŠØ± Ù†Ø¬Ø§Ø­ Ø¨Ø³ÙŠØ·Ø©</h4>
            <ul id="modalCriteria"></ul>
          </div>

          <div class="panel upload">
            <h4>Ø§Ù„ØªØ³Ù„ÙŠÙ…</h4>
            <textarea id="submissionText" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù„ Ø£Ùˆ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙŠ Ù†ÙØ°ØªÙ‡Ø§â€¦"></textarea>
            <input id="submissionFile" type="file" />
            <button class="btn primary" id="submitTask">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©</button>

            <div class="note" id="taskHint">
              * ÙÙŠ Ø§Ù„Ù€ MVP: ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙˆÙŠØ¸Ù‡Ø± ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨.
            </div>
          </div>
        </div>
      </div>

      <div class="modal-foot">
        <div class="note" id="modalFooterNote">â€”</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn" id="markSaved">Ø­ÙØ¸ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§ â­</button>
          <button class="btn" id="copyTask">Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</button>
        </div>
      </div>
    </div>
  </div>

  <!-- SUCCESS / REVIEW MODAL -->
  <div class="backdrop" id="successBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="successTitle" style="width:min(780px,100%);">
      <div class="modal-head">
        <div>
          <h3 id="successTitle">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© âœ…</h3>
          <p id="successSub">ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø¨Ø´ÙƒÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠØŒ ÙˆÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø´Ø±Ù Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù.</p>
        </div>
        <button class="btn small" id="closeSuccess">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
      </div>
      <div class="modal-body">
        <div class="grid-2">
          <div class="panel">
            <h4>Ù…Ù„Ø®Øµ Ø§Ù„ØªØ³Ù„ÙŠÙ…</h4>
            <p id="successSummary" class="muted" style="margin:0;"></p>
          </div>
          <div class="panel">
            <h4>Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©</h4>
            <ul>
              <li>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ <b>Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</b> Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø§Ù„Ø©.</li>
              <li>Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ø§Ù„Ø­Ø§Ù„Ø© <b>Needs Improvement</b> ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© Ø±ÙØ¹ Ù†Ø³Ø®Ø© Ù…Ø­Ø³Ù‘Ù†Ø©.</li>
              <li>Ù„Ù„Ø¹Ø±Ø¶: Ø§ÙØªØ­ <b>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</b> ÙˆØ§ÙƒØªØ¨ Ù…Ø±Ø§Ø¬Ø¹Ø©.</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="modal-foot">
        <div class="note">* Ù‡Ø°Ø§ Prototype â€” Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ø±Ø³Ø§Ù„ ÙØ¹Ù„ÙŠ Ø¥Ù„Ù‰ Ø®Ø§Ø¯Ù….</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn" data-view="dashboardView" id="goDashFromSuccess">Ø§Ø°Ù‡Ø¨ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</button>
          <button class="btn" data-view="adminView" id="goAdminFromSuccess">Ø§Ø°Ù‡Ø¨ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ONBOARDING MODAL -->
  <div class="backdrop show" id="onboardBackdrop" aria-hidden="false">
    <div class="onboard" role="dialog" aria-modal="true" aria-labelledby="onboardTitle">
      <div class="modal-head">
        <div>
          <h3 id="onboardTitle">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† (ØªØ¬Ø±ÙŠØ¨ÙŠ)</h3>
          <p>Ø§Ø®ØªØ± Ø¯ÙˆØ±Ùƒ ÙˆØ§Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø³ÙŠØ·Ø© â€” Ø¨Ø¯ÙˆÙ† ØªØ³Ø¬ÙŠÙ„ Ø­Ù‚ÙŠÙ‚ÙŠ</p>
        </div>
        <button class="btn small" id="skipOnboard">ØªØµÙØ­ ÙƒØ¶ÙŠÙ âœ•</button>
      </div>
      <div class="modal-body">
        <div class="panel">
          <h4>Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±</h4>
          <div class="role-pills" style="margin-top:8px;">
            <button class="role active" data-role="student">Ø·Ø§Ù„Ø¨</button>
            <button class="role" data-role="admin">Ù…Ø´Ø±Ù</button>
          </div>

          <div class="form" style="margin-top:14px;">
            <div class="row">
              <div class="field">
                <label>Ø§Ù„Ø§Ø³Ù…</label>
                <input id="onName" placeholder="Ù…Ø«Ø§Ù„: ØµØ§Ù„Ø­" />
              </div>
              <div class="field">
                <label>Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <input id="onUni" placeholder="Ù…Ø«Ø§Ù„: Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù…Ù„Ùƒ Ø³Ø¹ÙˆØ¯" />
              </div>
            </div>

            <div class="field">
              <label>Ù…Ù„Ø§Ø­Ø¸Ø©</label>
              <input disabled value="Ù‡Ø°Ø§ Ù†Ù…ÙˆØ°Ø¬ Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø¹Ø±Ø¶ â€” Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙØ­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ÙÙ‚Ø·." />
            </div>

            <button class="btn primary" id="enterApp">Ø¯Ø®ÙˆÙ„</button>
          </div>
        </div>
      </div>
      <div class="modal-foot">
        <div class="note">Ù†ØµÙŠØ­Ø© Ø¹Ø±Ø¶: Ø¬Ø±Ù‘Ø¨ ÙƒÙ€ â€œØ·Ø§Ù„Ø¨â€ Ø«Ù… Ø§ÙØªØ­ â€œÙ„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ùâ€ ÙˆØ±Ø§Ø¬Ø¹ ØªØ³Ù„ÙŠÙ…Ùƒ.</div>
        <button class="btn" id="demoFill">ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
      </div>
    </div>
  </div>

  <!-- GENERATE TASK MODAL -->
  <div class="backdrop" id="genBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="genTitle" style="width:min(820px,100%);">
      <div class="modal-head">
        <div>
          <h3 id="genTitle">âœ¨ ØªÙˆÙ„ÙŠØ¯ Ù…Ù‡Ù…Ø© Ù…Ù† ØªØ¹Ù„ÙŠÙ‚ (Demo NLP)</h3>
          <p>Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ù‹Ø§ Ø³Ù„Ø¨ÙŠÙ‹Ø§ Ø£Ùˆ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù† Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±ØŒ ÙˆØ³Ù†Ø­ÙˆÙ‘Ù„Ù‡ Ø¥Ù„Ù‰ Ù…Ù‡Ù…Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø¬Ø§Ù‡Ø²Ø©.</p>
        </div>
        <button class="btn small" id="closeGen">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
      </div>

      <div class="modal-body">
        <div class="grid-2">
          <div class="panel">
            <h4>Ø§ÙƒØªØ¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚</h4>
            <textarea id="genComment" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ù…Ø²Ø¯Ø­Ù… ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø¨Ø§Ù„Øº ÙˆØ§Ù„Ø±Ø¯ÙˆØ¯ Ù…ØªØ£Ø®Ø±Ø©..." style="min-height:140px;"></textarea>

            <div class="right-actions" style="margin-top:10px;">
              <button class="btn" id="fillExample1">ØªØ¬Ø±Ø¨Ø© Ù…Ø«Ø§Ù„ 1</button>
              <button class="btn" id="fillExample2">ØªØ¬Ø±Ø¨Ø© Ù…Ø«Ø§Ù„ 2</button>
              <button class="btn" id="fillExample3">ØªØ¬Ø±Ø¨Ø© Ù…Ø«Ø§Ù„ 3</button>
            </div>
          </div>

          <div class="panel">
            <h4>Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© (Preview)</h4>
            <div class="pill-row" id="genPreviewPills"></div>
            <div style="font-weight:900; margin-top:6px;" id="genPreviewTitle">â€”</div>
            <div class="muted" style="margin-top:6px;" id="genPreviewDesc">â€”</div>

            <hr style="border:none;border-top:1px solid var(--border);margin:12px 0;" />

            <div class="muted">
              * Ù‡Ø°Ø§ â€œDemo NLPâ€ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ù…Ø³ØªÙˆÙ‰.
              ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡ Ø¨Ù†Ù…ÙˆØ°Ø¬ NLP/LLM.
            </div>
          </div>
        </div>
      </div>

      <div class="modal-foot">
        <div class="note">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù….</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn primary" id="genCreateTask">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§</button>
          <button class="btn" id="genOnlyPreview">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast" role="status" aria-live="polite">
    <div>
      <strong id="toastTitle">â€”</strong><br />
      <span id="toastMsg">â€”</span>
    </div>
    <button class="btn small" id="toastClose">Ø­Ø³Ù†Ù‹Ø§</button>
  </div>

<script>
/** =========================
 *  Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (Tasks)
 *  ========================= **/
let TASKS = [
  {
    id:"T-001",
    title:"ØªØ­Ø³ÙŠÙ† Ø¹Ù†ÙˆØ§Ù† Ø®Ø¨Ø± Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙˆØ¶ÙˆØ­",
    category:"ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰",
    difficulty:"Ø³Ù‡Ù„",
    desc:"ÙˆØµÙ„Øª Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ØºÙŠØ± ÙˆØ§Ø¶Ø­ ÙˆÙŠØ­ØªÙˆÙŠ Ù…Ø¨Ø§Ù„ØºØ©. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØµÙŠØ§ØºØ© Ø¹Ù†ÙˆØ§Ù†ÙŠÙ† Ø¨Ø¯ÙŠÙ„ÙŠÙ† Ø£ÙƒØ«Ø± Ø¯Ù‚Ø©.",
    problem:"Ø¨Ø¹Ø¶ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ØªØ±Ù‰ Ø£Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ â€œÙ…Ø«ÙŠØ±â€ Ù„ÙƒÙ†Ù‡ Ù„Ø§ ÙŠØ¹ÙƒØ³ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø¨Ø± Ø¨Ø¯Ù‚Ø©ØŒ Ù…Ù…Ø§ ÙŠÙ‚Ù„Ù„ Ø§Ù„Ø«Ù‚Ø© ÙˆÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„ØªÙØ§Ø¹Ù„.",
    deliverables:["ØµÙŠØ§ØºØ© Ø¹Ù†ÙˆØ§Ù†ÙŠÙ† Ø¨Ø¯ÙŠÙ„ÙŠÙ† (Ù‚ØµÙŠØ± + Ù…ØªÙˆØ³Ø·).","Ø´Ø±Ø­ Ù…Ø®ØªØµØ±: Ù„Ù…Ø§Ø°Ø§ ÙƒÙ„ Ø¹Ù†ÙˆØ§Ù† Ø£ÙØ¶Ù„ØŸ"],
    criteria:["ÙˆØ¶ÙˆØ­ Ø§Ù„ÙÙƒØ±Ø© Ø¯ÙˆÙ† Ù…Ø¨Ø§Ù„ØºØ©.","Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ø®Ø¨Ø±.","Ù„ØºØ© Ø³Ù„ÙŠÙ…Ø© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©."],
    sourceHint:"Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø© (ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ØµØ¯Ø± Ø­ÙØ§Ø¸Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø®ØµÙˆØµÙŠØ©)."
  },
  {
    id:"T-002",
    title:"Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ù†Ø¨Ø±Ø© Ù…Ù†Ø´ÙˆØ± Ù„Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„",
    category:"ÙƒØªØ§Ø¨Ø© Ù…Ù†ØµØ§Øª",
    difficulty:"Ù…ØªÙˆØ³Ø·",
    desc:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± ØªÙ‚ÙˆÙ„ Ø¥Ù† Ù†Ø¨Ø±Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø±Ø³Ù…ÙŠØ© Ø¬Ø¯Ù‹Ø§. Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ù†Øµ Ù„ÙŠÙƒÙˆÙ† Ø£Ø®Ù ÙˆØ£ÙƒØ«Ø± Ù‚Ø±Ø¨Ù‹Ø§.",
    problem:"Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± ÙŠÙØ¶Ù‘Ù„ Ù†Ø¨Ø±Ø© Ø£Ø®Ù ÙˆØ£Ø³Ø±Ø¹ Ø¹Ù„Ù‰ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„. Ø§Ù„Ù†Øµ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ¨Ø¯Ùˆ â€œØ¨ÙŠØ§Ù† Ø±Ø³Ù…ÙŠâ€ ÙˆÙŠÙ‚Ù„Ù„ Ù…Ù† Ø§Ù„ØªÙØ§Ø¹Ù„.",
    deliverables:["Ø¥Ø¹Ø§Ø¯Ø© ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ± (Ù†Ø³Ø®ØªÙŠÙ†: ØªÙˆÙŠØªØ± + Ø¥Ù†Ø³ØªØºØ±Ø§Ù…).","Ø§Ù‚ØªØ±Ø§Ø­ CTA Ø¨Ø³ÙŠØ· (Ø¯Ø¹ÙˆØ© Ù„Ø§ØªØ®Ø§Ø° Ø¥Ø¬Ø±Ø§Ø¡)."],
    criteria:["Ù†Ø¨Ø±Ø© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ù…Ù†ØµØ©.","ÙˆØ¶ÙˆØ­ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø®Ù„Ø§Ù„ Ø«ÙˆØ§Ù†Ù.","CTA Ø¨Ø³ÙŠØ· ÙˆØºÙŠØ± Ù…Ø²Ø¹Ø¬."],
    sourceHint:"Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ Ù…Ø´Ø§Ø¨Ù‡."
  },
  {
    id:"T-003",
    title:"ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ø¨ØµØ±ÙŠ Ù„Ù‚Ø§Ù„Ø¨ Ø®Ø¨Ø±",
    category:"Ø¥Ø®Ø±Ø§Ø¬ ÙˆØªØµÙ…ÙŠÙ…",
    difficulty:"Ù…ØªÙˆØ³Ø·",
    desc:"Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± ÙŠØ±Ù‰ Ø£Ù† Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ù…Ø²Ø¯Ø­Ù…. Ø§Ù‚ØªØ±Ø­ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ ÙˆØ§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø¨ØµØ±ÙŠ.",
    problem:"Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù†Ø§ØµØ± ÙƒØ«ÙŠØ±Ø© ÙˆÙ…Ø³Ø§ÙØ§Øª Ø¶ÙŠÙ‚Ø©ØŒ Ù…Ù…Ø§ ÙŠØ³Ø¨Ø¨ ØªØ´ØªÙŠØª ÙˆÙŠÙ‚Ù„Ù„ Ù…Ù† ÙÙ‡Ù… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø³Ø±Ø¹Ø©.",
    deliverables:["Ù‚Ø§Ø¦Ù…Ø© ØªØ¹Ø¯ÙŠÙ„Ø§Øª (Ù…Ø³Ø§ÙØ§Øª/Ø®Ø·ÙˆØ·/ØªØ³Ù„Ø³Ù„).","Ø±Ø³Ù… ØªØ®Ø·ÙŠØ·ÙŠ Ø¨Ø³ÙŠØ· (Wireframe) Ø£Ùˆ ÙˆØµÙ Ù…Ø±Ø¦ÙŠ."],
    criteria:["ØªØ³Ù„Ø³Ù„ Ø¨ØµØ±ÙŠ ÙˆØ§Ø¶Ø­.","ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ´ØªÙŠØª ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.","Ø­Ù„ÙˆÙ„ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ° ÙˆÙ„ÙŠØ³Øª Ø¹Ø§Ù…Ø©."],
    sourceHint:"Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù†Ù‚Ø¯ Ù…ØªØ¹Ù„Ù‚ Ø¨ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©."
  },
  {
    id:"T-004",
    title:"ØªÙ†Ù‚ÙŠØ­ Ù†Øµ Ø¥Ø¹Ù„Ø§Ù…ÙŠ Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ù„ØªØ¨Ø§Ø³",
    category:"ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰",
    difficulty:"ØµØ¹Ø¨",
    desc:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª ØªØ´ÙŠØ± Ø£Ù† Ø§Ù„Ù†Øµ ÙŠØ³Ø¨Ø¨ Ø³ÙˆØ¡ ÙÙ‡Ù… Ø¨Ø³Ø¨Ø¨ Ù…ØµØ·Ù„Ø­Ø§Øª ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©. Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨ØªÙ‡ Ø¨Ù„ØºØ© Ø¯Ù‚ÙŠÙ‚Ø©.",
    problem:"Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØµØ·Ù„Ø­Ø§Øª ØºÙŠØ± Ù…Ø¹Ø±ÙØ© ÙŠÙØªØ­ Ø§Ù„Ø¨Ø§Ø¨ Ù„ØªÙØ³ÙŠØ±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ ÙˆÙ‡Ø°Ø§ ÙŠØ¶Ø¹Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠØ© ÙˆÙŠØ²ÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯.",
    deliverables:["Ø¥Ø¹Ø§Ø¯Ø© ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Øµ Ø¨ØµÙŠØ§ØºØ© Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙ…Ø®ØªØµØ±Ø©.","ØªØ­Ø¯ÙŠØ¯ 3 Ù…ØµØ·Ù„Ø­Ø§Øª Ø­Ø³Ø§Ø³Ø© ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø£Ùˆ ØªØ¹Ø±ÙŠÙÙ‡Ø§."],
    criteria:["ØªÙ‚Ù„ÙŠÙ„ Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø³ÙˆØ¡ Ø§Ù„ÙÙ‡Ù….","Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ ÙÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…Ø¹ ÙˆØ¶ÙˆØ­ ÙƒØ§Ù…Ù„.","Ù„ØºØ© Ù…Ù‡Ù†ÙŠØ© Ù…ØªÙˆØ§Ø²Ù†Ø©."],
    sourceHint:"Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ ÙˆØ¶ÙˆØ­ Ø§Ù„Ù†ØµÙˆØµ."
  },
  {
    id:"T-005",
    title:"Ø§Ù‚ØªØ±Ø§Ø­ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ ØªØ­Ø³ÙŠÙ† ØªÙˆØ§ØµÙ„ ÙØ±ÙŠÙ‚ Ø¥Ø¹Ù„Ø§Ù…ÙŠ",
    category:"Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙˆØ§ØµÙ„",
    difficulty:"Ø³Ù‡Ù„",
    desc:"ÙŠÙˆØ¬Ø¯ Ù†Ù‚Ø¯ Ø¨Ø£Ù† Ø§Ù„Ø±Ø¯ÙˆØ¯ Ù…ØªØ£Ø®Ø±Ø© ÙˆØºÙŠØ± Ù…Ù†Ø¸Ù…Ø©. ØµÙ…Ù‘Ù… SLA Ø¨Ø³ÙŠØ· + Ù‚ÙˆØ§Ù„Ø¨ Ø±Ø¯ÙˆØ¯.",
    problem:"Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªØ£Ø®Ø± Ø§Ù„Ø±Ø¯ Ø£Ùˆ ÙŠÙƒÙˆÙ† ØºÙŠØ± ÙˆØ§Ø¶Ø­ØŒ ÙŠØ´Ø¹Ø± Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø¨Ø§Ù„ØªØ¬Ø§Ù‡Ù„. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù†Ø¸Ø§Ù… Ø¨Ø³ÙŠØ· ÙŠØ±ÙØ¹ Ø¬ÙˆØ¯Ø© Ø§Ù„ØªÙˆØ§ØµÙ„.",
    deliverables:["SLA Ù…Ø¨Ø³Ø· (Ù…Ø«Ø§Ù„: Ø®Ù„Ø§Ù„ 2 Ø³Ø§Ø¹Ø©/24 Ø³Ø§Ø¹Ø©).","3 Ù‚ÙˆØ§Ù„Ø¨ Ø±Ø¯ Ø¬Ø§Ù‡Ø²Ø© (Ø§Ø³ØªÙØ³Ø§Ø±/Ø´ÙƒÙˆÙ‰/Ø§Ù‚ØªØ±Ø§Ø­)."],
    criteria:["Ø¨Ø³Ø§Ø·Ø© ÙˆØ³Ù‡ÙˆÙ„Ø© ØªØ·Ø¨ÙŠÙ‚.","ÙˆØ¶ÙˆØ­ Ø§Ù„Ù†Ø¨Ø±Ø© ÙˆØ§Ø­ØªØ±Ø§Ù… Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±.","ÙˆØ§Ù‚Ø¹ÙŠØ© ÙÙŠ Ø§Ù„Ø²Ù…Ù† Ø§Ù„Ù…Ù‚ØªØ±Ø­."],
    sourceHint:"Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù†Ù‚Ø¯ Ù…ØªØ¹Ù„Ù‚ Ø¨Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©."
  },
  {
    id:"T-006",
    title:"ØªØ­Ù„ÙŠÙ„ Ø³Ø¨Ø¨ Ø§Ù†Ø®ÙØ§Ø¶ Ø§Ù„ØªÙØ§Ø¹Ù„ ÙˆØ§Ù‚ØªØ±Ø§Ø­ ØªØ¯Ø®Ù„ Ø£Ø³Ø¨ÙˆØ¹ÙŠ",
    category:"ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡",
    difficulty:"ØµØ¹Ø¨",
    desc:"Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù†Ø®ÙØ¶ ÙØ¬Ø£Ø©. Ø§Ù‚ØªØ±Ø­ 3 ÙØ±Ø¶ÙŠØ§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ®Ø·Ø© ØªØ¯Ø®Ù„ Ù„Ù…Ø¯Ø© Ø£Ø³Ø¨ÙˆØ¹ Ø¨Ù…Ø¤Ø´Ø±Ø§Øª Ù‚ÙŠØ§Ø³.",
    problem:"Ø¨Ø¯ÙˆÙ† ØªØ­Ù„ÙŠÙ„ Ù…Ù†Ø¸Ù…ØŒ ÙŠØµØ¨Ø­ Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙØ±Ø¶ÙŠØ§Øª ÙˆØ§Ø¶Ø­Ø© ÙˆØ®Ø·Ø© ØªØ¯Ø®Ù„ Ù‚ØµÙŠØ±Ø© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù‚ÙŠØ§Ø³.",
    deliverables:["3 ÙØ±Ø¶ÙŠØ§Øª (Ø³Ø¨Ø¨ Ù…Ø­ØªÙ…Ù„ + ÙƒÙŠÙ Ù†ØªØ­Ù‚Ù‚).","Ø®Ø·Ø© Ø£Ø³Ø¨ÙˆØ¹: 3 Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª + Ù…Ø¤Ø´Ø± Ù‚ÙŠØ§Ø³ Ù„ÙƒÙ„ Ø¥Ø¬Ø±Ø§Ø¡."],
    criteria:["ÙØ±Ø¶ÙŠØ§Øª Ù…Ù†Ø·Ù‚ÙŠØ© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±.","Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…Ø­Ø¯Ø¯Ø© ÙˆÙ„ÙŠØ³Øª Ø¹Ø§Ù…Ø©.","Ù…Ø¤Ø´Ø±Ø§Øª Ù‚ÙŠØ§Ø³ ÙˆØ§Ø¶Ø­Ø©."],
    sourceHint:"Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ ØªØ±Ø§Ø¬Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„."
  }
];

/** =========================
 *  State
 *  ========================= **/
let state = {
  q:"",
  category:"all",
  difficulty:"all",
  statusTab:"all", // all|saved|submitted|reviewed|needs
  activeTask:null,

  saved:new Set(),             // taskIds
  submissions:[],              // {taskId, studentName, studentUni, text, fileName, submittedAt, status, reviewerNote}
  user:{ role:"guest", name:"Ø¶ÙŠÙ", uni:"" }
};

/** =========================
 *  Utils
 *  ========================= **/
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

function showToast(title, msg){
  $("#toastTitle").textContent = title;
  $("#toastMsg").textContent = msg;
  $("#toast").classList.add("show");
}
function hideToast(){ $("#toast").classList.remove("show"); }

function switchView(id){
  $$(".view").forEach(v => v.classList.remove("active"));
  const el = document.getElementById(id);
  if(el) el.classList.add("active");
  window.scrollTo({ top: 0, behavior: "smooth" });
}

function pillForDifficulty(level){
  if(level === "Ø³Ù‡Ù„") return `<span class="pill good">Ø³Ù‡Ù„</span>`;
  if(level === "Ù…ØªÙˆØ³Ø·") return `<span class="pill mid">Ù…ØªÙˆØ³Ø·</span>`;
  return `<span class="pill hard">ØµØ¹Ø¨</span>`;
}
function statusPillForTask(taskId){
  const s = state.submissions.find(x => x.taskId === taskId && x.studentName === state.user.name);
  if(!s) return "";
  if(s.status === "submitted") return `<span class="pill good">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</span>`;
  if(s.status === "reviewed") return `<span class="pill reviewed">ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>`;
  if(s.status === "needs") return `<span class="pill needs">Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†</span>`;
  return "";
}

function normalize(s){ return (s||"").toLowerCase(); }

function closeBackdrop(backdropId){
  const el = document.getElementById(backdropId);
  el.classList.remove("show");
  el.setAttribute("aria-hidden", "true");
}
function openBackdrop(backdropId){
  const el = document.getElementById(backdropId);
  el.classList.add("show");
  el.setAttribute("aria-hidden", "false");
}

/** =========================
 *  Filters + Render Tasks
 *  ========================= **/
function initFilters(){
  const categories = Array.from(new Set(TASKS.map(t => t.category))).sort();
  const sel = $("#category");
  sel.innerHTML = `<option value="all">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>`;
  categories.forEach(c=>{
    const opt = document.createElement("option");
    opt.value=c; opt.textContent=c;
    sel.appendChild(opt);
  });
  $("#statTasks").textContent = `${TASKS.length} Ù…Ù‡Ø§Ù…`;
}

function matchesStatusTab(taskId){
  const saved = state.saved.has(taskId);
  const sub = state.submissions.find(s => s.taskId === taskId && s.studentName === state.user.name);

  switch(state.statusTab){
    case "saved": return saved;
    case "submitted": return !!sub && sub.status === "submitted";
    case "reviewed": return !!sub && sub.status === "reviewed";
    case "needs": return !!sub && sub.status === "needs";
    default: return true;
  }
}

function getFilteredTasks(){
  const q = normalize(state.q.trim());
  return TASKS.filter(t=>{
    const matchesQ = !q || (
      normalize(t.title).includes(q) ||
      normalize(t.desc).includes(q) ||
      normalize(t.category).includes(q) ||
      normalize(t.difficulty).includes(q)
    );
    const matchesCat = (state.category === "all") || (t.category === state.category);
    const matchesDiff = (state.difficulty === "all") || (t.difficulty === state.difficulty);
    const matchesTab = matchesStatusTab(t.id);
    return matchesQ && matchesCat && matchesDiff && matchesTab;
  });
}

function renderTasks(){
  const list = getFilteredTasks();
  const grid = $("#tasksGrid");
  grid.innerHTML = "";

  if(list.length === 0){
    grid.innerHTML = `
      <div class="card" style="grid-column:1/-1;text-align:center;">
        <h3 style="margin:0 0 8px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</h3>
        <p style="margin:0;">Ø¬Ø±Ù‘Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø£Ùˆ Ø§Ù„ÙÙ„Ø§ØªØ± Ø£Ùˆ Ø§Ù„ØªØ¨ÙˆÙŠØ¨.</p>
      </div>`;
    return;
  }

  list.forEach(t=>{
    const saved = state.saved.has(t.id);
    const statusPill = statusPillForTask(t.id);

    const card = document.createElement("div");
    card.className = "card task-card";
    card.innerHTML = `
      <div class="pill-row">
        <span class="pill">${escapeHtml(t.category)}</span>
        ${pillForDifficulty(t.difficulty)}
        ${saved ? `<span class="pill">Ù…Ø­ÙÙˆØ¸Ø© â­</span>` : ``}
        ${statusPill}
      </div>
      <h3 class="task-title">${escapeHtml(t.title)}</h3>
      <p class="task-desc">${escapeHtml(t.desc)}</p>
      <div class="task-footer">
        <span class="meta">Ù…Ø¹Ø±Ù‘Ù: ${escapeHtml(t.id)}</span>
        <button class="btn small primary" data-open="${escapeHtml(t.id)}">ÙØªØ­ Ø§Ù„Ù…Ù‡Ù…Ø©</button>
      </div>
    `;
    grid.appendChild(card);
  });

  $$("[data-open]").forEach(btn=>{
    btn.addEventListener("click", ()=> openTask(btn.getAttribute("data-open")));
  });
}

/** =========================
 *  Task Modal
 *  ========================= **/
function openTask(id){
  const t = TASKS.find(x=>x.id===id);
  if(!t) return;

  state.activeTask = t;

  $("#modalTitle").textContent = t.title;
  $("#modalSubtitle").textContent = t.desc;

  const pills = [];
  pills.push(`<span class="pill">${escapeHtml(t.category)}</span>`);
  pills.push(pillForDifficulty(t.difficulty));
  if(state.saved.has(t.id)) pills.push(`<span class="pill">Ù…Ø­ÙÙˆØ¸Ø© â­</span>`);

  const mySub = state.submissions.find(s => s.taskId === t.id && s.studentName === state.user.name);
  if(mySub){
    if(mySub.status === "submitted") pills.push(`<span class="pill good">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</span>`);
    if(mySub.status === "reviewed") pills.push(`<span class="pill reviewed">ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>`);
    if(mySub.status === "needs") pills.push(`<span class="pill needs">Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†</span>`);
  }
  $("#modalPills").innerHTML = pills.join("");

  $("#modalProblem").textContent = t.problem;

  const del = $("#modalDeliverables"); del.innerHTML = "";
  t.deliverables.forEach(x=>{
    const li=document.createElement("li"); li.textContent=x; del.appendChild(li);
  });

  const cr = $("#modalCriteria"); cr.innerHTML = "";
  t.criteria.forEach(x=>{
    const li=document.createElement("li"); li.textContent=x; cr.appendChild(li);
  });

  $("#modalFooterNote").textContent = t.sourceHint;

  if(mySub && mySub.status === "needs"){
    $("#taskHint").textContent = "ğŸ”´ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ† â€” Ø§Ø±ÙØ¹ Ù†Ø³Ø®Ø© Ù…Ø­Ø³Ù‘Ù†Ø© Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.";
  }else{
    $("#taskHint").textContent = "* ÙÙŠ Ø§Ù„Ù€ MVP: ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙˆÙŠØ¸Ù‡Ø± ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨.";
  }

  $("#submissionText").value = mySub?.text || "";
  $("#submissionFile").value = "";

  openBackdrop("backdrop");
}

function closeTask(){
  state.activeTask = null;
  closeBackdrop("backdrop");
}

/** =========================
 *  Submissions (Student)
 *  ========================= **/
function submitActiveTask(){
  const t = state.activeTask;
  if(!t) return;

  if(state.user.role !== "student"){
    showToast("ØªÙ†Ø¨ÙŠÙ‡", "Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ù‡Ù…Ø© ÙŠØ¬Ø¨ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ€ Ø·Ø§Ù„Ø¨.");
    openOnboarding();
    return;
  }

  const text = $("#submissionText").value.trim();
  const file = $("#submissionFile").files?.[0];

  if(!text && !file){
    showToast("Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„", "Ø§ÙƒØªØ¨ Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù„ Ø£Ùˆ Ø§Ø±ÙØ¹ Ù…Ù„Ù ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.");
    return;
  }

  state.submissions = state.submissions.filter(s => !(s.taskId===t.id && s.studentName===state.user.name));

  state.submissions.push({
    taskId: t.id,
    studentName: state.user.name,
    studentUni: state.user.uni || "",
    text,
    fileName: file ? file.name : null,
    submittedAt: new Date().toISOString(),
    status: "submitted",
    reviewerNote: ""
  });

  closeTask();
  renderAll();

  $("#successSummary").textContent =
    `Ø§Ù„Ù…Ù‡Ù…Ø©: ${t.id} â€” ${t.title}\n` +
    `Ù…Ù„Ø®Øµ: ${text ? text.slice(0, 120) + (text.length>120 ? "â€¦" : "") : "â€”"}\n` +
    `Ù…Ù„Ù: ${file ? file.name : "Ù„Ø§ ÙŠÙˆØ¬Ø¯"}`;

  openBackdrop("successBackdrop");
}

function toggleSave(){
  const t = state.activeTask;
  if(!t) return;

  if(state.saved.has(t.id)){
    state.saved.delete(t.id);
    showToast("ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡", "ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ù…Ø© Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª.");
  }else{
    state.saved.add(t.id);
    showToast("ØªÙ… Ø§Ù„Ø­ÙØ¸ â­", "ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ù…Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.");
  }
  openTask(t.id);
  renderAll();
}

async function copyTaskDetails(){
  const t = state.activeTask;
  if(!t) return;

  const content =
`Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©: ${t.title}
Ø§Ù„Ù…Ø¹Ø±Ù: ${t.id}
Ø§Ù„ØªØµÙ†ÙŠÙ: ${t.category}
Ø§Ù„Ù…Ø³ØªÙˆÙ‰: ${t.difficulty}

ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:
${t.problem}

Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:
- ${t.deliverables.join("\n- ")}

Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­:
- ${t.criteria.join("\n- ")}
`;
  try{
    await navigator.clipboard.writeText(content);
    showToast("ØªÙ… Ø§Ù„Ù†Ø³Ø® ğŸ“‹", "ØªÙ… Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©.");
  }catch{
    showToast("ØªØ¹Ø°Ø± Ø§Ù„Ù†Ø³Ø®", "Ø§Ù„Ù…ØªØµÙØ­ Ù…Ù†Ø¹ Ø§Ù„Ù†Ø³Ø®. Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠÙ‹Ø§.");
  }
}

/** =========================
 *  Dashboard Render
 *  ========================= **/
function getMySubmissions(){
  if(state.user.role !== "student") return [];
  return state.submissions.filter(s => s.studentName === state.user.name);
}
function myTaskStatus(taskId){
  if(state.user.role !== "student") return "â€”";
  const s = state.submissions.find(x => x.taskId === taskId && x.studentName === state.user.name);
  if(s?.status === "submitted") return "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„";
  if(s?.status === "reviewed") return "ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©";
  if(s?.status === "needs") return "Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†";
  if(state.saved.has(taskId)) return "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°";
  return "â€”";
}
function renderDashboard(){
  if(state.user.role !== "student"){
    $("#dashTable").innerHTML = `<tr><td colspan="4" class="muted">Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ·Ø§Ù„Ø¨ Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨.</td></tr>`;
    $("#dashInProgress").textContent = "â€”";
    $("#dashSubmitted").textContent = "â€”";
    $("#dashReviewed").textContent = "â€”";
    return;
  }

  const mySubs = getMySubmissions();
  const inProgress = Array.from(state.saved).filter(id => !mySubs.some(s => s.taskId === id)).length;
  const submitted = mySubs.filter(s => s.status === "submitted").length;
  const reviewed = mySubs.filter(s => s.status === "reviewed" || s.status === "needs").length;

  $("#dashInProgress").textContent = inProgress;
  $("#dashSubmitted").textContent = submitted;
  $("#dashReviewed").textContent = reviewed;

  const ids = new Set([...Array.from(state.saved), ...mySubs.map(s=>s.taskId)]);
  const rows = Array.from(ids).map(id=>{
    const t = TASKS.find(x=>x.id===id);
    if(!t) return null;
    const sub = mySubs.find(s=>s.taskId===id);
    const status = myTaskStatus(id);

    let statusBadge = `<span class="pill">${status}</span>`;
    if(status === "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„") statusBadge = `<span class="pill good">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</span>`;
    if(status === "ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©") statusBadge = `<span class="pill reviewed">ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>`;
    if(status === "Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†") statusBadge = `<span class="pill needs">Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†</span>`;
    if(status === "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°") statusBadge = `<span class="pill">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</span>`;

    const actionButtons = [];
    actionButtons.push(`<button class="btn small" data-open="${escapeHtml(id)}">ÙØªØ­</button>`);
    if(sub && sub.status === "needs"){
      actionButtons.push(`<button class="btn small primary" data-open="${escapeHtml(id)}">Ø¥Ø¹Ø§Ø¯Ø© Ø±ÙØ¹</button>`);
    }

    const note = sub?.reviewerNote ? `<div class="muted" style="margin-top:6px;">ğŸ“ ${escapeHtml(sub.reviewerNote)}</div>` : "";

    return `
      <tr>
        <td><b>${escapeHtml(id)}</b></td>
        <td>
          <div style="font-weight:900;">${escapeHtml(t.title)}</div>
          <div class="muted">${escapeHtml(t.category)} â€¢ ${escapeHtml(t.difficulty)}</div>
          ${note}
        </td>
        <td>${statusBadge}</td>
        <td><div class="right-actions">${actionButtons.join("")}</div></td>
      </tr>
    `;
  }).filter(Boolean);

  $("#dashTable").innerHTML = rows.length ? rows.join("") : `<tr><td colspan="4" class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø¨Ø¹Ø¯. Ø§Ø­ÙØ¸ Ù…Ù‡Ù…Ø© Ø£Ùˆ Ø£Ø±Ø³Ù„ ØªØ³Ù„ÙŠÙ….</td></tr>`;

  $$(`#dashTable [data-open]`).forEach(btn=>{
    btn.addEventListener("click", ()=> openTask(btn.getAttribute("data-open")));
  });
}

/** =========================
 *  Admin Render + Review
 *  ========================= **/
function renderAdmin(){
  if(state.user.role !== "admin"){
    $("#adminTable").innerHTML = `<tr><td colspan="6" class="muted">Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø´Ø±Ù Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¹Ø±Ø¶ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.</td></tr>`;
    $("#adminSubCount").textContent = "â€”";
    $("#adminPendingCount").textContent = "â€”";
    return;
  }

  $("#adminSubCount").textContent = state.submissions.length;
  $("#adminPendingCount").textContent = state.submissions.filter(s=>s.status==="submitted").length;

  const rows = state.submissions
    .slice()
    .sort((a,b)=> (b.submittedAt||"").localeCompare(a.submittedAt||""))
    .map(s=>{
      const t = TASKS.find(x=>x.id===s.taskId);
      const statusPill =
        s.status==="submitted" ? `<span class="pill good">Ù…Ø¹Ù„Ù‚Ø©</span>` :
        s.status==="reviewed" ? `<span class="pill reviewed">ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>` :
        s.status==="needs" ? `<span class="pill needs">Ø¨Ø­Ø§Ø¬Ø© ØªØ­Ø³ÙŠÙ†</span>` : `<span class="pill">${escapeHtml(s.status)}</span>`;

      const noteVal = s.reviewerNote || "";

      return `
        <tr>
          <td><b>${escapeHtml(s.taskId)}</b></td>
          <td>
            <div style="font-weight:900;">${escapeHtml(s.studentName)}</div>
            <div class="muted">${escapeHtml(s.studentUni || "â€”")}</div>
          </td>
          <td>
            <div style="font-weight:900;">${escapeHtml(t?.title || "â€”")}</div>
            <div class="muted">${escapeHtml(t?.category || "â€”")} â€¢ ${escapeHtml(t?.difficulty || "â€”")}</div>
            <div class="muted" style="margin-top:6px;">
              ğŸ—‚ Ù…Ù„Ù: ${escapeHtml(s.fileName || "Ù„Ø§ ÙŠÙˆØ¬Ø¯")}<br/>
              âœï¸ Ù…Ù„Ø®Øµ: ${escapeHtml((s.text||"â€”").slice(0,110) + ((s.text||"").length>110 ? "â€¦" : ""))}
            </div>
          </td>
          <td>${statusPill}</td>
          <td>
            <input class="adminNote" data-task="${escapeAttr(s.taskId)}" data-student="${escapeAttr(s.studentName)}"
              value="${escapeAttr(noteVal)}" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ø®ØªØµØ±Ø©â€¦" style="width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);outline:none;">
          </td>
          <td>
            <div class="right-actions">
              <button class="btn small success" data-action="reviewed" data-task="${escapeAttr(s.taskId)}" data-student="${escapeAttr(s.studentName)}">Reviewed</button>
              <button class="btn small danger" data-action="needs" data-task="${escapeAttr(s.taskId)}" data-student="${escapeAttr(s.studentName)}">Needs</button>
            </div>
          </td>
        </tr>
      `;
    });

  $("#adminTable").innerHTML = rows.length ? rows.join("") : `<tr><td colspan="6" class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ù„ÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯. Ø§Ø¯Ø®Ù„ ÙƒØ·Ø§Ù„Ø¨ ÙˆØ£Ø±Ø³Ù„ Ù…Ù‡Ù…Ø©.</td></tr>`;

  $$(`#adminTable [data-action]`).forEach(btn=>{
    btn.addEventListener("click", ()=> {
      const action = btn.getAttribute("data-action");
      const taskId = btn.getAttribute("data-task");
      const student = btn.getAttribute("data-student");
      setReview(taskId, student, action);
    });
  });
}

function setReview(taskId, studentName, action){
  const noteInput = $(`#adminTable .adminNote[data-task="${cssEscape(taskId)}"][data-student="${cssEscape(studentName)}"]`);
  const note = noteInput ? noteInput.value.trim() : "";

  const idx = state.submissions.findIndex(s => s.taskId===taskId && s.studentName===studentName);
  if(idx === -1){
    showToast("Ø®Ø·Ø£", "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ØªØ³Ù„ÙŠÙ….");
    return;
  }

  state.submissions[idx].reviewerNote = note;
  state.submissions[idx].status = (action === "reviewed") ? "reviewed" : "needs";

  renderAll();
  showToast("ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© âœ…", `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© ${taskId} Ù„Ù„Ø·Ø§Ù„Ø¨ ${studentName}.`);
}

/** =========================
 *  Admin Add Task
 *  ========================= **/
function addTaskFromAdmin(){
  if(state.user.role !== "admin"){
    showToast("ØªÙ†Ø¨ÙŠÙ‡", "ÙŠØ¬Ø¨ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø´Ø±Ù Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©.");
    openOnboarding();
    return;
  }

  const title = $("#adminTitle").value.trim();
  const category = $("#adminCategory").value.trim();
  const difficulty = $("#adminDifficulty").value.trim();
  const desc = $("#adminDesc").value.trim();
  const problem = $("#adminProblem").value.trim();

  if(!title || !category || !difficulty || !desc || !problem){
    showToast("Ù†Ù‚Øµ Ø¨ÙŠØ§Ù†Ø§Øª", "Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©.");
    return;
  }

  const nextNum = TASKS.length + 1;
  const id = "T-" + String(nextNum).padStart(3,"0");

  TASKS.push({
    id, title, category, difficulty,
    desc, problem,
    deliverables:["Ø§ÙƒØªØ¨/ØµÙ…Ù‘Ù… Ø§Ù„Ù…Ø®Ø±Ø¬ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø­Ø³Ø¨ ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø©.","Ø§Ø±ÙÙ‚ Ø´Ø±Ø­ Ù…Ø®ØªØµØ± Ù„Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø°ÙŠ Ø§ØªØ®Ø°ØªÙ‡."],
    criteria:["ÙˆØ¶ÙˆØ­ Ø§Ù„Ø­Ù„.","Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.","Ø§ØªØ³Ø§Ù‚ Ù…Ø¹ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©."],
    sourceHint:"Ù…Ù‡Ù…Ø© Ø£Ø¶ÙŠÙØª Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù (Demo)."
  });

  $("#adminTitle").value="";
  $("#adminCategory").value="";
  $("#adminDifficulty").value="";
  $("#adminDesc").value="";
  $("#adminProblem").value="";

  initFilters();
  renderAll();
  showToast("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…", `ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ${id}.`);
}

/** =========================
 *  User / Onboarding
 *  ========================= **/
function openOnboarding(){ openBackdrop("onboardBackdrop"); }
function closeOnboarding(){ closeBackdrop("onboardBackdrop"); }

function setRole(role){
  state.user.role = role;
  $$(".role").forEach(r => r.classList.toggle("active", r.getAttribute("data-role") === role));
}

function applyUserUI(){
  const isGuest = state.user.role === "guest";
  const isStudent = state.user.role === "student";
  const isAdmin = state.user.role === "admin";

  $("#userChip").style.display = isGuest ? "none" : "inline-flex";
  $("#userNameChip").textContent = state.user.name || "â€”";
  $("#userRoleChip").textContent = isStudent ? "Ø·Ø§Ù„Ø¨" : (isAdmin ? "Ù…Ø´Ø±Ù" : "Ø¶ÙŠÙ");

  $("#navDashboard").style.display = isStudent ? "inline-flex" : "none";
  $("#navAdmin").style.display = isAdmin ? "inline-flex" : "none";
  $("#goDashBtn").style.display = isStudent ? "inline-flex" : "none";
  $("#startNow").textContent = isGuest ? "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†" : "ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…";

  $("#subtitle").textContent = isAdmin
    ? "ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø´Ø±Ù â€” Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…Ø§Øª"
    : "Ù†Ù‚Ø¯ Ø­Ù‚ÙŠÙ‚ÙŠ. ØªØ¯Ø±ÙŠØ¨ Ø­Ù‚ÙŠÙ‚ÙŠ. Ø£Ø«Ø± Ø­Ù‚ÙŠÙ‚ÙŠ.      ";

  $("#newTaskCTA").textContent = isGuest ? "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†" : "Ø§Ø³ØªØ¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù…";
}

function login(role, name, uni){
  state.user.role = role;
  state.user.name = name || (role==="admin" ? "Ù…Ø´Ø±Ù" : "Ø·Ø§Ù„Ø¨");
  state.user.uni = uni || "";

  applyUserUI();

  if(role === "admin"){
    switchView("adminView");
  }else if(role === "student"){
    switchView("tasksView");
  }else{
    switchView("homeView");
  }
}

function logout(){
  state.user = { role:"guest", name:"Ø¶ÙŠÙ", uni:"" };
  applyUserUI();
  switchView("homeView");
  showToast("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬", "Ø±Ø¬Ø¹Øª Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¶ÙŠÙ.");
}

/** =========================
 *  Render all
 *  ========================= **/
function renderAll(){
  renderTasks();
  renderDashboard();
  renderAdmin();
  $("#statTasks").textContent = `${TASKS.length} Ù…Ù‡Ø§Ù…`;
}

/** =========================
 *  Escaping helpers
 *  ========================= **/
function escapeHtml(str){
  return (str||"").replace(/[&<>"']/g, m => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[m]));
}
function escapeAttr(str){
  return escapeHtml(str).replace(/"/g, "&quot;");
}
function cssEscape(str){
  return (str||"").replace(/"/g,'\\"');
}

/** =========================
 *  Demo NLP: Generate Task from Comment
 *  ========================= **/
function openGenModal(){
  $("#genComment").value = "";
  updateGenPreview();
  openBackdrop("genBackdrop");
}
function closeGenModal(){ closeBackdrop("genBackdrop"); }

function analyzeComment(comment){
  const c = (comment || "").toLowerCase();

  const buckets = [
    {
      category: "Ø¥Ø®Ø±Ø§Ø¬ ÙˆØªØµÙ…ÙŠÙ…",
      difficulty: "Ù…ØªÙˆØ³Ø·",
      keywords: ["ØªØµÙ…ÙŠÙ…", "Ø£Ù„ÙˆØ§Ù†", "Ø®Ø·", "Ù…Ø²Ø¯Ø­Ù…", "ØªØ±ØªÙŠØ¨", "layout", "ui", "ux", "Ø¥Ø®Ø±Ø§Ø¬", "Ù‚Ø§Ù„Ø¨", "ØµÙˆØ±Ø©", "Ù…Ø±Ø¦ÙŠ", "ÙÙŠØ¬ÙˆØ§Ù„"],
      title: "ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ø¨ØµØ±ÙŠ ÙˆØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©",
      template: "Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± ÙŠØ±Ù‰ Ø£Ù† Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬/Ø§Ù„ØªØµÙ…ÙŠÙ… ØºÙŠØ± Ù…Ø±ÙŠØ­ Ø£Ùˆ Ù…Ø²Ø¯Ø­Ù…. Ø§Ù‚ØªØ±Ø­ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø¨ØµØ±ÙŠ ÙˆØ§Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ø®Ø·ÙˆØ·."
    },
    {
      category: "ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰",
      difficulty: "Ø³Ù‡Ù„",
      keywords: ["Ø¹Ù†ÙˆØ§Ù†", "Ù…Ø¨Ø§Ù„Øº", "ÙˆØ§Ø¶Ø­", "ØºÙŠØ± ÙˆØ§Ø¶Ø­", "ØµÙŠØ§ØºØ©", "Ø¥Ù…Ù„Ø§Ø¡", "Ù„ØºØ©", "Ù…Ø­ØªÙˆÙ‰", "Ù†Øµ", "ØºÙ„Ø·", "Ù…Ø¶Ù„Ù„", "Ø§Ù„ØªØ¨Ø§Ø³"],
      title: "ØªØ­Ø³ÙŠÙ† ØµÙŠØ§ØºØ© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù†Øµ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙˆØ¶ÙˆØ­",
      template: "Ù‡Ù†Ø§Ùƒ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ ÙˆØ¶ÙˆØ­ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†/Ø§Ù„Ù†Øµ. Ø£Ø¹Ø¯ ØµÙŠØ§ØºØ© Ø¹Ù†ÙˆØ§Ù†ÙŠÙ† Ø¨Ø¯ÙŠÙ„ÙŠÙ† ÙˆÙ†Øµ Ù…Ø®ØªØµØ± Ø£ÙƒØ«Ø± Ø¯Ù‚Ø©."
    },
    {
      category: "ÙƒØªØ§Ø¨Ø© Ù…Ù†ØµØ§Øª",
      difficulty: "Ù…ØªÙˆØ³Ø·",
      keywords: ["ØªÙˆÙŠØªØ±", "Ø§Ù†Ø³ØªØºØ±Ø§Ù…", "Ø³Ù†Ø§Ø¨", "ØªÙŠÙƒ", "ØªØ±Ù†Ø¯", "Ù†Ø¨Ø±Ø©", "Ø±Ø³Ù…ÙŠ", "Ø«Ù‚ÙŠÙ„", "Ø³ÙˆØ´ÙŠØ§Ù„", "Ù‡Ø§Ø´ØªØ§Ù‚", "caption"],
      title: "Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ù†Ø¨Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„",
      template: "Ø§Ù„Ù†Ø¨Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ø§ ØªÙ†Ø§Ø³Ø¨ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„. Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ù„ØªÙƒÙˆÙ† Ø£Ø®Ù ÙˆØ£Ù‚Ø±Ø¨ Ù„Ù„Ø¬Ù…Ù‡ÙˆØ± Ù…Ø¹ CTA ÙˆØ§Ø¶Ø­."
    },
    {
      category: "Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙˆØ§ØµÙ„",
      difficulty: "Ø³Ù‡Ù„",
      keywords: ["Ø±Ø¯", "Ø§Ù„Ø±Ø¯ÙˆØ¯", "Ù…ØªØ£Ø®Ø±", "ØªØ¬Ø§Ù‡Ù„", "ØªÙˆØ§ØµÙ„", "Ø®Ø¯Ù…Ø©", "Ø´ÙƒÙˆÙ‰", "Ø§Ø³ØªØ¬Ø§Ø¨Ø©", "ØªØ¹Ø§Ù…Ù„", "Ø³Ù„ÙˆÙƒ"],
      title: "ØªØµÙ…ÙŠÙ… Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø±Ø¯ÙˆØ¯ ÙˆØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªÙˆØ§ØµÙ„",
      template: "Ù‡Ù†Ø§Ùƒ Ù†Ù‚Ø¯ Ø­ÙˆÙ„ ØªØ£Ø®Ø± Ø§Ù„Ø±Ø¯ÙˆØ¯ ÙˆØ¹Ø¯Ù… ÙˆØ¶ÙˆØ­Ù‡Ø§. ØµÙ…Ù‘Ù… SLA Ø¨Ø³ÙŠØ· + Ù‚ÙˆØ§Ù„Ø¨ Ø±Ø¯ÙˆØ¯ Ù…Ø®ØªØµØ±Ø©."
    },
    {
      category: "ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡",
      difficulty: "ØµØ¹Ø¨",
      keywords: ["ØªÙØ§Ø¹Ù„", "Ø§Ù†Ø®ÙØ§Ø¶", "ÙˆØµÙˆÙ„", "Ù…Ø´Ø§Ù‡Ø¯Ø§Øª", "engagement", "kpi", "ØªØ­Ù„ÙŠÙ„", "Ø£Ø±Ù‚Ø§Ù…", "Ù†Ø³Ø¨Ø©", "Ù‡Ø¨ÙˆØ·"],
      title: "ØªØ­Ù„ÙŠÙ„ Ø³Ø¨Ø¨ Ø§Ù†Ø®ÙØ§Ø¶ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù‚ØªØ±Ø§Ø­ ØªØ¯Ø®Ù„ Ø³Ø±ÙŠØ¹",
      template: "ÙŠÙˆØ¬Ø¯ Ø§Ù†Ø®ÙØ§Ø¶ Ù…Ù„Ø­ÙˆØ¸ ÙÙŠ Ø§Ù„Ø£Ø¯Ø§Ø¡. Ø§Ù‚ØªØ±Ø­ ÙØ±Ø¶ÙŠØ§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ®Ø·Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© Ø¨Ù…Ø¤Ø´Ø±Ø§Øª Ù‚ÙŠØ§Ø³."
    }
  ];

  let best = { score: 0, bucket: null };
  for(const b of buckets){
    let score = 0;
    for(const k of b.keywords){
      if(c.includes(k)) score += 1;
    }
    if(score > best.score){
      best = { score, bucket: b };
    }
  }

  if(!best.bucket){
    return {
      category: "ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰",
      difficulty: "Ù…ØªÙˆØ³Ø·",
      title: "ØªØ­ÙˆÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¹Ø§Ù…Ø© Ø¥Ù„Ù‰ Ù…Ù‡Ù…Ø© ØªØ­Ø³ÙŠÙ†",
      desc: "Ù…Ù„Ø§Ø­Ø¸Ø© Ø¹Ø§Ù…Ø© Ù…Ù† Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± ØªØ­ØªØ§Ø¬ ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ø®Ø·ÙˆØ§Øª Ø¹Ù…Ù„ ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…Ø®Ø±Ø¬Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ³Ù„ÙŠÙ….",
      problem: comment || "â€”",
      deliverables: [
        "ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©.",
        "Ø§Ù‚ØªØ±Ø§Ø­ 3 ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¹Ù…Ù„ÙŠØ© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ°.",
        "ØªØ­Ø¯ÙŠØ¯ Ù…Ø®Ø±Ø¬ Ù†Ù‡Ø§Ø¦ÙŠ (Ù†Øµ/ØªØµÙ…ÙŠÙ…/Ø®Ø·Ø©) Ø­Ø³Ø¨ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©."
      ],
      criteria: ["ÙˆØ¶ÙˆØ­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©.","Ø­Ù„ÙˆÙ„ Ù…Ø­Ø¯Ø¯Ø© ÙˆÙ„ÙŠØ³Øª Ø¹Ø§Ù…Ø©.","Ù…Ø®Ø±Ø¬Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø¹Ø±Ø¶."]
    };
  }

  const intenseWords = ["ÙƒØ§Ø±Ø«ÙŠ", "Ø³ÙŠØ¡ Ø¬Ø¯Ù‹Ø§", "ÙØ¶ÙŠØ­Ø©", "Ø¶Ø¹ÙŠÙ Ø¬Ø¯Ù‹Ø§", "Ù…Ø³ØªØ­ÙŠÙ„", "Ù…Ø±Ø©", "Ù„Ù„Ø£Ù…Ø§Ù†Ø©"];
  let difficulty = best.bucket.difficulty;
  if(intenseWords.some(w => c.includes(w))) difficulty = "ØµØ¹Ø¨";

  const deliverablesMap = {
    "Ø¥Ø®Ø±Ø§Ø¬ ÙˆØªØµÙ…ÙŠÙ…": [
      "Ù‚Ø§Ø¦Ù…Ø© ØªØ¹Ø¯ÙŠÙ„Ø§Øª (Ù…Ø³Ø§ÙØ§Øª/Ø®Ø·ÙˆØ·/ØªØ¨Ø§ÙŠÙ†/ØªØ³Ù„Ø³Ù„).",
      "Ø±Ø³Ù… ØªØ®Ø·ÙŠØ·ÙŠ (Wireframe) Ø£Ùˆ ÙˆØµÙ Ù…Ø±Ø¦ÙŠ Ù„Ù„Ø­Ù„."
    ],
    "ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰": [
      "ØµÙŠØ§ØºØ© Ø¹Ù†ÙˆØ§Ù†ÙŠÙ† Ø¨Ø¯ÙŠÙ„ÙŠÙ†.",
      "Ø¥Ø¹Ø§Ø¯Ø© ÙƒØªØ§Ø¨Ø© ÙÙ‚Ø±Ø© Ù…Ø®ØªØµØ±Ø© Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ù‹Ø§."
    ],
    "ÙƒØªØ§Ø¨Ø© Ù…Ù†ØµØ§Øª": [
      "Ù†Ø³Ø®ØªÙŠÙ†: ØªÙˆÙŠØªØ± + Ø¥Ù†Ø³ØªØºØ±Ø§Ù… (Ø£Ùˆ Ù…Ù†ØµØ© ØªØ®ØªØ§Ø±Ù‡Ø§).",
      "CTA Ù…Ù†Ø§Ø³Ø¨ + Ø§Ù‚ØªØ±Ø§Ø­ Ù‡Ø§Ø´ØªØ§Ù‚Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)."
    ],
    "Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙˆØ§ØµÙ„": [
      "SLA Ù…Ø¨Ø³Ø· Ù„Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©.",
      "3 Ù‚ÙˆØ§Ù„Ø¨ Ø±Ø¯ Ø¬Ø§Ù‡Ø²Ø© (Ø§Ø³ØªÙØ³Ø§Ø±/Ø´ÙƒÙˆÙ‰/Ø§Ù‚ØªØ±Ø§Ø­)."
    ],
    "ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡": [
      "3 ÙØ±Ø¶ÙŠØ§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ø³Ø¨Ø¨ + Ø·Ø±ÙŠÙ‚Ø© ØªØ­Ù‚Ù‚).",
      "Ø®Ø·Ø© Ø£Ø³Ø¨ÙˆØ¹: Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª + KPI Ù„ÙƒÙ„ Ø¥Ø¬Ø±Ø§Ø¡."
    ]
  };

  return {
    category: best.bucket.category,
    difficulty,
    title: best.bucket.title,
    desc: best.bucket.template,
    problem: comment || "â€”",
    deliverables: deliverablesMap[best.bucket.category] || ["ØªØ³Ù„ÙŠÙ… Ù…Ø®Ø±Ø¬ ÙˆØ§Ø¶Ø­ Ù…Ø±ØªØ¨Ø· Ø¨Ø§Ù„Ù…Ø´ÙƒÙ„Ø©."],
    criteria: ["Ø­Ù„ÙˆÙ„ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ°.","ÙˆØ¶ÙˆØ­ ÙˆØªØ³Ù„Ø³Ù„ Ù…Ù†Ø·Ù‚ÙŠ.","Ø§ØªØ³Ø§Ù‚ Ø§Ù„Ù…Ø®Ø±Ø¬ Ù…Ø¹ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©."]
  };
}

function updateGenPreview(){
  const comment = ($("#genComment").value || "").trim();
  const analysis = analyzeComment(comment);

  $("#genPreviewPills").innerHTML = `
    <span class="pill">${escapeHtml(analysis.category)}</span>
    ${pillForDifficulty(analysis.difficulty)}
    <span class="pill">Demo NLP</span>
  `;
  $("#genPreviewTitle").textContent = analysis.title;
  $("#genPreviewDesc").textContent = analysis.desc;

  return analysis;
}

function createTaskFromComment(){
  const comment = ($("#genComment").value || "").trim();
  if(!comment){
    showToast("Ù†Ù‚Øµ Ø¨ÙŠØ§Ù†Ø§Øª", "Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ù‹Ø§ Ø£ÙˆÙ„Ù‹Ø§ Ø«Ù… Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…Ù‡Ù…Ø©.");
    return;
  }

  const analysis = updateGenPreview();
  const nextNum = TASKS.length + 1;
  const id = "T-" + String(nextNum).padStart(3,"0");

  TASKS.push({
    id,
    title: analysis.title,
    category: analysis.category,
    difficulty: analysis.difficulty,
    desc: analysis.desc,
    problem: analysis.problem,
    deliverables: analysis.deliverables,
    criteria: analysis.criteria,
    sourceHint: "Ù…Ù‡Ù…Ø© Ù…ÙˆÙ„Ù‘Ø¯Ø© Ù…Ù† ØªØ¹Ù„ÙŠÙ‚ (Demo NLP)."
  });

  initFilters();
  renderAll();
  closeGenModal();
  showToast("ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù‡Ù…Ø© âœ¨", `ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ${id} Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.`);
}

/** =========================
 *  Events
 *  ========================= **/
function wireEvents(){
  $$("[data-view]").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const id = btn.getAttribute("data-view");

      if(id === "dashboardView" && state.user.role !== "student"){
        showToast("ØªÙ†Ø¨ÙŠÙ‡", "Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ·Ø§Ù„Ø¨ Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨.");
        openOnboarding();
        return;
      }
      if(id === "adminView" && state.user.role !== "admin"){
        showToast("ØªÙ†Ø¨ÙŠÙ‡", "Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø´Ø±Ù Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù.");
        openOnboarding();
        return;
      }
      switchView(id);
    });
  });

  $("#goHome").addEventListener("click", ()=> switchView("homeView"));

  $("#startNow").addEventListener("click", ()=> openOnboarding());
  $("#newTaskCTA").addEventListener("click", ()=>{
    if(state.user.role === "guest"){ openOnboarding(); }
    else switchView("tasksView");
  });

  $$("#statusTabs .tab").forEach(tab=>{
    tab.addEventListener("click", ()=>{
      $$("#statusTabs .tab").forEach(t=>t.classList.remove("active"));
      tab.classList.add("active");
      state.statusTab = tab.getAttribute("data-status");
      renderTasks();
    });
  });

  $("#q").addEventListener("input", e=>{ state.q = e.target.value; renderTasks(); });
  $("#category").addEventListener("change", e=>{ state.category = e.target.value; renderTasks(); });
  $("#difficulty").addEventListener("change", e=>{ state.difficulty = e.target.value; renderTasks(); });
  $("#reset").addEventListener("click", ()=>{
    state.q=""; state.category="all"; state.difficulty="all";
    $("#q").value=""; $("#category").value="all"; $("#difficulty").value="all";
    showToast("ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·", "ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙÙ„Ø§ØªØ± ÙˆØ§Ù„Ø¨Ø­Ø« Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ.");
    renderTasks();
  });

  $("#closeModal").addEventListener("click", closeTask);
  $("#backdrop").addEventListener("click", (e)=>{ if(e.target === $("#backdrop")) closeTask(); });
  document.addEventListener("keydown", (e)=>{ if(e.key==="Escape" && $("#backdrop").classList.contains("show")) closeTask(); });

  $("#submitTask").addEventListener("click", submitActiveTask);
  $("#markSaved").addEventListener("click", toggleSave);
  $("#copyTask").addEventListener("click", copyTaskDetails);

  $("#openDemoTask").addEventListener("click", ()=>{
    switchView("tasksView");
    openTask("T-003");
  });

  $("#toastClose").addEventListener("click", hideToast);

  $("#closeSuccess").addEventListener("click", ()=> closeBackdrop("successBackdrop"));
  $("#successBackdrop").addEventListener("click", (e)=>{ if(e.target === $("#successBackdrop")) closeBackdrop("successBackdrop"); });
  document.addEventListener("keydown", (e)=>{ if(e.key==="Escape" && $("#successBackdrop").classList.contains("show")) closeBackdrop("successBackdrop"); });

  $("#goDashFromSuccess").addEventListener("click", ()=>{
    closeBackdrop("successBackdrop");
    if(state.user.role !== "student"){ openOnboarding(); return; }
    switchView("dashboardView");
  });
  $("#goAdminFromSuccess").addEventListener("click", ()=>{
    closeBackdrop("successBackdrop");
    openOnboarding();
    showToast("ØªÙ„Ù…ÙŠØ­", "Ø§Ø®ØªØ± Ø¯ÙˆØ± â€œÙ…Ø´Ø±Ùâ€ Ø«Ù… Ø§ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ….");
  });

  $("#goDashBtn").addEventListener("click", ()=>{
    if(state.user.role !== "student"){ openOnboarding(); return; }
    switchView("dashboardView");
  });

  $("#logoutBtn").addEventListener("click", logout);
  $("#logoutAdminBtn").addEventListener("click", logout);

  $("#adminAddTask").addEventListener("click", addTaskFromAdmin);

  $$(".role").forEach(r=>{
    r.addEventListener("click", ()=> setRole(r.getAttribute("data-role")));
  });

  $("#skipOnboard").addEventListener("click", ()=>{
    state.user = { role:"guest", name:"Ø¶ÙŠÙ", uni:"" };
    closeOnboarding();
    applyUserUI();
    switchView("homeView");
  });

  $("#demoFill").addEventListener("click", ()=>{
    $("#onName").value = "ØµØ§Ù„Ø­ (Demo)";
    $("#onUni").value = "Ø¬Ø§Ù…Ø¹Ø© (Demo)";
  });

  $("#enterApp").addEventListener("click", ()=>{
    const selected = $(".role.active")?.getAttribute("data-role") || "student";
    const name = $("#onName").value.trim();
    const uni = $("#onUni").value.trim();

    closeOnboarding();
    login(selected, name || (selected==="admin" ? "Ù…Ø´Ø±Ù (Demo)" : "Ø·Ø§Ù„Ø¨ (Demo)"), uni);
    showToast("ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ âœ…", selected==="admin" ? "Ø£Ù†Øª Ø§Ù„Ø¢Ù† ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø´Ø±Ù." : "Ø£Ù†Øª Ø§Ù„Ø¢Ù† ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø§Ù„Ø¨.");
    renderAll();
  });

  // Generate Task modal (Demo NLP)
  $("#genFromCommentBtn")?.addEventListener("click", openGenModal);
  $("#closeGen")?.addEventListener("click", closeGenModal);
  $("#genBackdrop")?.addEventListener("click", (e)=>{ if(e.target === $("#genBackdrop")) closeGenModal(); });

  $("#genOnlyPreview")?.addEventListener("click", ()=>{
    updateGenPreview();
    showToast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©", "ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ÙˆØªØ­Ø¯ÙŠØ« ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©.");
  });

  $("#genCreateTask")?.addEventListener("click", createTaskFromComment);
  $("#genComment")?.addEventListener("input", updateGenPreview);

  $("#fillExample1")?.addEventListener("click", ()=>{
    $("#genComment").value = "Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ù…Ø²Ø¯Ø­Ù… ÙˆØ§Ù„Ø®Ø· ØµØºÙŠØ± ÙˆØ§Ù„Ù‡ÙˆØ§Ù…Ø´ Ù‚Ù„ÙŠÙ„Ø©. ØµØ±Øª Ù…Ø§ Ø£Ù‚Ø¯Ø± Ø£Ù‚Ø±Ø£ Ø¨Ø³Ø±Ø¹Ø©.";
    updateGenPreview();
  });
  $("#fillExample2")?.addEventListener("click", ()=>{
    $("#genComment").value = "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø¨Ø§Ù„Øº ÙˆÙ…Ø¶Ù„Ù„ØŒ ÙˆØ§Ù„Ù†Øµ ÙÙŠÙ‡ Ù…ØµØ·Ù„Ø­Ø§Øª ØªØ³Ø¨Ø¨ Ø§Ù„ØªØ¨Ø§Ø³. Ù†Ø­ØªØ§Ø¬ ØµÙŠØ§ØºØ© Ø£ÙˆØ¶Ø­.";
    updateGenPreview();
  });
  $("#fillExample3")?.addEventListener("click", ()=>{
    $("#genComment").value = "Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù†Ø®ÙØ¶ Ø¨Ø´ÙƒÙ„ ÙˆØ§Ø¶Ø­ Ø¢Ø®Ø± Ø£Ø³Ø¨ÙˆØ¹. Ù†Ø­ØªØ§Ø¬ ØªØ­Ù„ÙŠÙ„ Ø³Ø±ÙŠØ¹ ÙˆØ®Ø·Ø© ØªØ¯Ø®Ù„ Ù„Ù…Ø¯Ø© Ø£Ø³Ø¨ÙˆØ¹ Ø¨Ù…Ø¤Ø´Ø±Ø§Øª Ù‚ÙŠØ§Ø³.";
    updateGenPreview();
  });
}

/** =========================
 *  Boot
 *  ========================= **/
function boot(){
  // default role in onboarding
  state.user.role = "student";
  setRole("student");

  initFilters();
  applyUserUI();
  wireEvents();
  renderAll();
}

boot();
</script>
</body>
</html>
